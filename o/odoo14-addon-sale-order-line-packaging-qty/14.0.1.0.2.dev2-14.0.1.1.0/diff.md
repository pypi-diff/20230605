# Comparing `tmp/odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2-py3-none-any.whl.zip` & `tmp/odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,21 +1,21 @@
-Zip file size: 25763 bytes, number of entries: 19
--rw-r--r--  2.0 unx     3289 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/README.rst
--rw-r--r--  2.0 unx       21 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/__init__.py
--rw-r--r--  2.0 unx      602 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/__manifest__.py
--rw-r--r--  2.0 unx     1486 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/i18n/es.po
--rw-r--r--  2.0 unx     1679 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/i18n/sale_order_line_packaging_qty.pot
--rw-r--r--  2.0 unx       30 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/models/__init__.py
--rw-r--r--  2.0 unx     3995 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/models/sale_order_line.py
--rw-r--r--  2.0 unx      127 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       80 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/readme/CREDITS.rst
--rw-r--r--  2.0 unx      130 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx     9455 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/static/description/icon.png
--rw-r--r--  2.0 unx    12914 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/static/description/index.html
--rw-r--r--  2.0 unx       49 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/tests/__init__.py
--rw-r--r--  2.0 unx     4006 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/tests/test_sale_order_line_packaging_qty.py
--rw-r--r--  2.0 unx     2417 b- defN 22-Jun-03 04:26 odoo/addons/sale_order_line_packaging_qty/views/sale_order.xml
--rw-r--r--  2.0 unx     3935 b- defN 22-Jun-03 04:30 odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Jun-03 04:30 odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Jun-03 04:30 odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2278 b- defN 22-Jun-03 04:30 odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/RECORD
-19 files, 46590 bytes uncompressed, 21769 bytes compressed:  53.3%
+Zip file size: 25758 bytes, number of entries: 19
+-rw-r--r--  2.0 unx     3289 b- defN 23-Jun-05 14:07 odoo/addons/sale_order_line_packaging_qty/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/__init__.py
+-rw-r--r--  2.0 unx      602 b- defN 23-Jun-05 14:07 odoo/addons/sale_order_line_packaging_qty/__manifest__.py
+-rw-r--r--  2.0 unx     1486 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/i18n/es.po
+-rw-r--r--  2.0 unx     1679 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/i18n/sale_order_line_packaging_qty.pot
+-rw-r--r--  2.0 unx       30 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/models/__init__.py
+-rw-r--r--  2.0 unx     4090 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/models/sale_order_line.py
+-rw-r--r--  2.0 unx      127 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       80 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/readme/CREDITS.rst
+-rw-r--r--  2.0 unx      130 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/static/description/icon.png
+-rw-r--r--  2.0 unx    12914 b- defN 23-Jun-05 14:07 odoo/addons/sale_order_line_packaging_qty/static/description/index.html
+-rw-r--r--  2.0 unx       49 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/tests/__init__.py
+-rw-r--r--  2.0 unx     4966 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/tests/test_sale_order_line_packaging_qty.py
+-rw-r--r--  2.0 unx     2417 b- defN 23-Jun-05 14:06 odoo/addons/sale_order_line_packaging_qty/views/sale_order.xml
+-rw-r--r--  2.0 unx     3930 b- defN 23-Jun-05 14:07 odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-05 14:07 odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-05 14:07 odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2258 b- defN 23-Jun-05 14:07 odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/RECORD
+19 files, 47620 bytes uncompressed, 21804 bytes compressed:  54.2%
```

## zipnote {}

```diff
@@ -39,20 +39,20 @@
 
 Filename: odoo/addons/sale_order_line_packaging_qty/tests/test_sale_order_line_packaging_qty.py
 Comment: 
 
 Filename: odoo/addons/sale_order_line_packaging_qty/views/sale_order.xml
 Comment: 
 
-Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/METADATA
+Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/WHEEL
+Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/top_level.txt
+Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/RECORD
+Filename: odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/sale_order_line_packaging_qty/__manifest__.py

```diff
@@ -1,13 +1,13 @@
 # Copyright 2020 Camptocamp SA
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl)
 {
     "name": "Sale Order Line Packaging Quantity",
     "summary": "Define quantities according to product packaging on sale order lines",
-    "version": "14.0.1.0.1",
+    "version": "14.0.1.1.0",
     "development_status": "Alpha",
     "category": "Warehouse Management",
     "website": "https://github.com/OCA/sale-workflow",
     "author": "Camptocamp, Odoo Community Association (OCA)",
     "license": "AGPL-3",
     "application": False,
     "installable": True,
```

## odoo/addons/sale_order_line_packaging_qty/models/sale_order_line.py

```diff
@@ -1,11 +1,12 @@
 # Copyright 2020 Camptocamp SA
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl)
 from odoo import _, api, fields, models
 from odoo.exceptions import UserError
+from odoo.tools import float_is_zero, float_round
 
 
 class SaleOrderLine(models.Model):
 
     _inherit = "sale.order.line"
 
     product_packaging_qty = fields.Float(
@@ -30,20 +31,30 @@
             # Consider uom
             if sol.product_id.uom_id != sol.product_uom:
                 product_qty = sol.product_uom._compute_quantity(
                     sol.product_uom_qty, sol.product_id.uom_id
                 )
             else:
                 product_qty = sol.product_uom_qty
-            if product_qty % sol.product_packaging.qty:
+            qty_mod = float_round(
+                product_qty % sol.product_packaging.qty,
+                precision_rounding=sol.product_packaging.product_uom_id.rounding,
+            )
+            # After the rounding, the value could be equals to sol.product_packaging.qty
+            # So just re-apply the '%'
+            qty_mod = qty_mod % sol.product_packaging.qty
+            if not float_is_zero(
+                qty_mod,
+                precision_digits=sol.product_packaging.product_uom_id.rounding,
+            ):
                 # If qty does not fit in package reset package qty
                 sol.product_packaging_qty = 0
             else:
                 # Maybe that product_packaging_qty should be an Integer, no ?
-                qty = product_qty // sol.product_packaging.qty
+                qty = product_qty / sol.product_packaging.qty
                 sol.product_packaging_qty = qty
 
     def _prepare_product_packaging_qty_values(self):
         return {
             "product_uom_qty": self.product_packaging.qty * self.product_packaging_qty,
             "product_uom": self.product_packaging.product_uom_id.id,
         }
@@ -84,19 +95,7 @@
                     "product_uom_qty": product_qty,
                     "product_uom": self.product_id.uom_id,
                 }
             )
         else:
             self.update({"product_packaging_qty": 0})
         return super()._onchange_product_packaging()
-
-    @api.onchange("product_uom_qty")
-    def _onchange_product_uom_qty(self):
-        """
-        Ensure a warning is raised when changing the package if the qty
-        is not a multiple of the package qty.
-        """
-        # TODO Drop once https://github.com/odoo/odoo/pull/49150/ is merged
-        res = super()._onchange_product_uom_qty()
-        if not res:
-            res = self._check_package()
-        return res
```

## odoo/addons/sale_order_line_packaging_qty/tests/test_sale_order_line_packaging_qty.py

```diff
@@ -5,61 +5,88 @@
 
 
 class TestSaleOrderLinePackagingQty(SavepointCase):
     @classmethod
     def setUpClass(cls):
         super().setUpClass()
         cls.env = cls.env(context=dict(cls.env.context, tracking_disable=True))
+        cls.precision = cls.env["decimal.precision"].precision_get(
+            "Product Unit of Measure"
+        )
         cls.partner = cls.env.ref("base.res_partner_12")
         cls.product = cls.env.ref("product.product_product_9")
+        cls.product_no_pckg = cls.env.ref("product.product_product_10")
         cls.packaging = cls.env["product.packaging"].create(
             {"name": "Test packaging", "product_id": cls.product.id, "qty": 5.0}
         )
-        cls.product_no_pckg = cls.env.ref("product.product_product_10")
+        cls.packaging2 = cls.env["product.packaging"].create(
+            {"name": "Test packaging", "product_id": cls.product.id, "qty": 2.2}
+        )
 
     def test_product_packaging_qty(self):
         order = self.env["sale.order"].create({"partner_id": self.partner.id})
         order_line = self.env["sale.order.line"].create(
             {
                 "order_id": order.id,
                 "product_id": self.product.id,
                 "product_uom": self.product.uom_id.id,
                 "product_uom_qty": 3.0,
             }
         )
-        order_line.write({"product_packaging": self.packaging})
-        # This is what actually happened when user adds so line
-        order_line._onchange_product_uom_qty()
-        order_line._compute_product_packaging_qty()
+        order_line.write({"product_packaging": self.packaging.id})
         order_line._onchange_product_packaging()
-        order_line._onchange_product_packaging_qty()
-        self.assertEqual(order_line.product_uom_qty, 5.0)
-        self.assertEqual(order_line.product_packaging_qty, 1.0)
-
-        order_line.write({"product_packaging_qty": 3.0})
-        order_line._onchange_product_packaging_qty()
-        self.assertEqual(order_line.product_uom_qty, 15.0)
-
-        order_line.write({"product_uom_qty": 9.0})
-        self.assertEqual(order_line.product_packaging_qty, 0.0)
-        order_line.write({"product_uom_qty": 15.0})
-
-        dozen = self.env.ref("uom.product_uom_dozen")
-        order_line.product_uom = dozen
+        self.assertAlmostEqual(
+            order_line.product_uom_qty, self.packaging.qty, places=self.precision
+        )
+        self.assertAlmostEqual(
+            order_line.product_packaging_qty, 1.0, places=self.precision
+        )
+        pack_qty = 3.0
+        order_line.write({"product_packaging_qty": pack_qty})
         order_line._compute_product_packaging_qty()
-        self.assertEqual(order_line.product_uom_qty, 180.0)
-        self.assertEqual(order_line.product_uom, self.product.uom_id)
-
-        self.packaging.qty = 0
-        with self.assertRaises(UserError):
-            order_line.write({"product_packaging_qty": 0.0})
+        self.assertAlmostEqual(
+            order_line.product_uom_qty,
+            self.packaging.qty * pack_qty,
+            places=self.precision,
+        )
+        self.assertAlmostEqual(
+            order_line.product_packaging_qty, pack_qty, places=self.precision
+        )
 
-        order_line.product_packaging = False
+    def test_product_packaging_qty_float(self):
+        order = self.env["sale.order"].create({"partner_id": self.partner.id})
+        order_line = self.env["sale.order.line"].create(
+            {
+                "order_id": order.id,
+                "product_id": self.product.id,
+                "product_uom": self.product.uom_id.id,
+                "product_uom_qty": 7,
+            }
+        )
+        order_line.write({"product_packaging": self.packaging2.id})
         order_line._onchange_product_packaging()
-        self.assertEqual(order_line.product_packaging_qty, 0.0)
+        self.assertAlmostEqual(
+            order_line.product_uom_qty, self.packaging2.qty, places=self.precision
+        )
+        self.assertAlmostEqual(
+            order_line.product_packaging_qty, 1.0, places=self.precision
+        )
+        pack_qty = 7
+        order_line.write({"product_packaging_qty": pack_qty})
+        # Via interface, this compute is triggered and could cause some issue.
+        # So simulate it.
+        order_line._compute_product_packaging_qty()
+        self.assertAlmostEqual(
+            order_line.product_uom_qty,
+            self.packaging2.qty * pack_qty,
+            places=self.precision,
+        )
+        self.assertAlmostEqual(
+            order_line.product_packaging_qty, pack_qty, places=self.precision
+        )
 
     def test_product_packaging_qty_wo_packaging(self):
         order = self.env["sale.order"].create({"partner_id": self.partner.id})
         order_line = self.env["sale.order.line"].create(
             {
                 "order_id": order.id,
                 "product_id": self.product_no_pckg.id,
```

## Comparing `odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/METADATA` & `odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-sale-order-line-packaging-qty
-Version: 14.0.1.0.2.dev2
+Version: 14.0.1.1.0
 Summary: Define quantities according to product packaging on sale order lines
 Home-page: https://github.com/OCA/sale-workflow
 Author: Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/RECORD` & `odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/RECORD`

 * *Files 13% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 odoo/addons/sale_order_line_packaging_qty/README.rst,sha256=omXxBhAj1rMnMNnA1vW8jT2UErG7ECiaW_-0i6RysGE,3289
 odoo/addons/sale_order_line_packaging_qty/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/sale_order_line_packaging_qty/__manifest__.py,sha256=oFmCjFMB3huL17vHCXOtaZY4lbqj5AmWz-D7-83tXz8,602
+odoo/addons/sale_order_line_packaging_qty/__manifest__.py,sha256=3XK64UTEPo4gfNeyu4JVZ3Vr77HnnHi77Kcw7sWk3pg,602
 odoo/addons/sale_order_line_packaging_qty/i18n/es.po,sha256=zHKgkbsEPkp_YNSWKn841Ex72HoYsCV0izI1FcXBCUE,1486
 odoo/addons/sale_order_line_packaging_qty/i18n/sale_order_line_packaging_qty.pot,sha256=LtUBCkW03UaoHnFvt_V_4coKBP2uMuD-wnY-PGWs0W4,1679
 odoo/addons/sale_order_line_packaging_qty/models/__init__.py,sha256=0XTNG-MzihYtVvjGhNDM789gpRyLtTlIZGa1FuLbzV8,30
-odoo/addons/sale_order_line_packaging_qty/models/sale_order_line.py,sha256=FsDYW2KhHS4iTlMfdhVimsi9fgYQfXdeXROqUkfHCiM,3995
+odoo/addons/sale_order_line_packaging_qty/models/sale_order_line.py,sha256=Yqx3NhivL5fO-5i1mtAQIzOIWExIZvBebkk2jiz-0j0,4090
 odoo/addons/sale_order_line_packaging_qty/readme/CONTRIBUTORS.rst,sha256=3jCiU_4p-KbytOIDDJGT_i1OBRPyaK-cC4tg2LvKWns,127
 odoo/addons/sale_order_line_packaging_qty/readme/CREDITS.rst,sha256=qJic0c2qWDTloupuq6j69JdIEo70Xpy6-b4MZho00Og,80
 odoo/addons/sale_order_line_packaging_qty/readme/DESCRIPTION.rst,sha256=fHQRw8cNcc3KSx0ZBFBbPRmpZWb-oWGeF2-pxuWEC3I,130
 odoo/addons/sale_order_line_packaging_qty/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/sale_order_line_packaging_qty/static/description/index.html,sha256=2IYpISN2Zh1XfYjHaFZiYHrU8X2uu8rg6FVJ2x2bsjA,12914
 odoo/addons/sale_order_line_packaging_qty/tests/__init__.py,sha256=JR_Jy-y7tmECDkBPC_IolmAov0fmmPIg3nygNoOKULs,49
-odoo/addons/sale_order_line_packaging_qty/tests/test_sale_order_line_packaging_qty.py,sha256=v2Y1UiGAOPBrcXnBnNKR4IJi46Okuhj1UlNVsml9gQc,4006
+odoo/addons/sale_order_line_packaging_qty/tests/test_sale_order_line_packaging_qty.py,sha256=BDWOMB71YNpsDK5qXa58jhZ6ZdPoSaOQ65SaMcb8Xr8,4966
 odoo/addons/sale_order_line_packaging_qty/views/sale_order.xml,sha256=Kj2kncFoZOcgN8-H45dog9Neip9eIQaxstBitO1Yc4I,2417
-odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/METADATA,sha256=kfPVjbwdwyIYbJiuFTM-FVrhraOBNPhRS-aQCqRMfcY,3935
-odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_sale_order_line_packaging_qty-14.0.1.0.2.dev2.dist-info/RECORD,,
+odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/METADATA,sha256=pCZwq9Wqqy52g5AJUdb-dCLYWbXAZ5cId8_iAPJ1sns,3930
+odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_sale_order_line_packaging_qty-14.0.1.1.0.dist-info/RECORD,,
```

