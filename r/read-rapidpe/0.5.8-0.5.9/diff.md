# Comparing `tmp/read_rapidpe-0.5.8.tar.gz` & `tmp/read_rapidpe-0.5.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "read_rapidpe-0.5.8.tar", max compression
+gzip compressed data, was "read_rapidpe-0.5.9.tar", max compression
```

## Comparing `read_rapidpe-0.5.8.tar` & `read_rapidpe-0.5.9.tar`

### file list

```diff
@@ -1,11 +1,11 @@
--rw-r--r--   0        0        0     2399 2023-04-17 13:15:50.969962 read_rapidpe-0.5.8/README.md
--rw-r--r--   0        0        0      627 2023-06-04 21:28:07.931502 read_rapidpe-0.5.8/pyproject.toml
--rw-r--r--   0        0        0      342 2023-06-04 17:50:03.396354 read_rapidpe-0.5.8/read_rapidpe/__init__.py
--rw-r--r--   0        0        0    11295 2023-05-13 16:31:51.989559 read_rapidpe-0.5.8/read_rapidpe/grid_point.py
--rw-r--r--   0        0        0     3620 2023-06-03 15:19:21.433555 read_rapidpe-0.5.8/read_rapidpe/io.py
--rw-r--r--   0        0        0     6083 2023-04-16 13:20:01.614285 read_rapidpe-0.5.8/read_rapidpe/p_astro.py
--rw-r--r--   0        0        0     9718 2023-04-07 15:04:09.805939 read_rapidpe-0.5.8/read_rapidpe/parser.py
--rw-r--r--   0        0        0     5890 2023-06-04 20:42:24.365320 read_rapidpe-0.5.8/read_rapidpe/plot.py
--rw-r--r--   0        0        0    33571 2023-06-04 21:10:40.192878 read_rapidpe-0.5.8/read_rapidpe/result.py
--rw-r--r--   0        0        0     8855 2023-06-03 14:39:22.849276 read_rapidpe-0.5.8/read_rapidpe/transform.py
--rw-r--r--   0        0        0     3330 1970-01-01 00:00:00.000000 read_rapidpe-0.5.8/PKG-INFO
+-rw-r--r--   0        0        0     2399 2023-04-17 13:15:50.969962 read_rapidpe-0.5.9/README.md
+-rw-r--r--   0        0        0      627 2023-06-05 00:15:43.290147 read_rapidpe-0.5.9/pyproject.toml
+-rw-r--r--   0        0        0      342 2023-06-04 17:50:03.396354 read_rapidpe-0.5.9/read_rapidpe/__init__.py
+-rw-r--r--   0        0        0    11295 2023-05-13 16:31:51.989559 read_rapidpe-0.5.9/read_rapidpe/grid_point.py
+-rw-r--r--   0        0        0     3620 2023-06-03 15:19:21.433555 read_rapidpe-0.5.9/read_rapidpe/io.py
+-rw-r--r--   0        0        0     6083 2023-04-16 13:20:01.614285 read_rapidpe-0.5.9/read_rapidpe/p_astro.py
+-rw-r--r--   0        0        0     9718 2023-04-07 15:04:09.805939 read_rapidpe-0.5.9/read_rapidpe/parser.py
+-rw-r--r--   0        0        0     5890 2023-06-04 20:42:24.365320 read_rapidpe-0.5.9/read_rapidpe/plot.py
+-rw-r--r--   0        0        0    33548 2023-06-05 00:14:27.919501 read_rapidpe-0.5.9/read_rapidpe/result.py
+-rw-r--r--   0        0        0     8855 2023-06-03 14:39:22.849276 read_rapidpe-0.5.9/read_rapidpe/transform.py
+-rw-r--r--   0        0        0     3330 1970-01-01 00:00:00.000000 read_rapidpe-0.5.9/PKG-INFO
```

### Comparing `read_rapidpe-0.5.8/README.md` & `read_rapidpe-0.5.9/README.md`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/pyproject.toml` & `read_rapidpe-0.5.9/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "read-rapidpe"
-version = "0.5.8"
+version = "0.5.9"
 description = "Read and analyse results generated by rapidpe-rift-pipe"
 authors = ["Cory Chu <cory@gwlab.page>"]
 readme = "README.md"
 packages = [{include = "read_rapidpe"}]
 homepage = "https://github.com/c0rychu/read-rapidpe"
 repository = "https://git.ligo.org/yu-kuang.chu/read-rapidpe"
```

### Comparing `read_rapidpe-0.5.8/read_rapidpe/grid_point.py` & `read_rapidpe-0.5.9/read_rapidpe/grid_point.py`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/read_rapidpe/io.py` & `read_rapidpe-0.5.9/read_rapidpe/io.py`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/read_rapidpe/p_astro.py` & `read_rapidpe-0.5.9/read_rapidpe/p_astro.py`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/read_rapidpe/parser.py` & `read_rapidpe-0.5.9/read_rapidpe/parser.py`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/read_rapidpe/plot.py` & `read_rapidpe-0.5.9/read_rapidpe/plot.py`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/read_rapidpe/result.py` & `read_rapidpe-0.5.9/read_rapidpe/result.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,14 +24,16 @@
 from .transform import Mass_Spin
 
 from matplotlib.tri import Triangulation
 from matplotlib.tri import LinearTriInterpolator, CubicTriInterpolator
 from scipy.interpolate import LinearNDInterpolator, NearestNDInterpolator
 from scipy.interpolate import CloughTocher2DInterpolator
 from scipy.stats import multinomial
+from scipy.special import logsumexp
+
 
 # import time  # for profiling
 
 
 def unique_with_tolerance(array, tolerance):
     tolerance = np.abs(tolerance)
     sorted_array = np.sort(array)
@@ -797,29 +799,28 @@
                 mask = self.iteration == gl
                 sigma_x1 = grid_separation_min(
                     self.x1[mask]) * gaussian_sigma_to_grid_size_ratio
                 sigma_x2 = grid_separation_min(
                     self.x2[mask]) * gaussian_sigma_to_grid_size_ratio
                 cov[gl] = np.diag([sigma_x1**2, sigma_x2**2])
 
-            # Compute likelihood at each grid point
-            likelihood = np.exp(self.marg_log_likelihood)
-            sum_likelihood = np.sum(likelihood)
+            # Compute normalized relative likelihood at each grid point
+            prob = np.exp(self.marg_log_likelihood
+                          - logsumexp(self.marg_log_likelihood))
 
             # Compute number of samples for each grid point
-            N_multinomial = multinomial(N*20, likelihood/sum_likelihood)
+            N_multinomial = multinomial(N*20, prob)
             N_per_grid_point = N_multinomial.rvs(1)[0]
 
             # Generate samples
             samples = np.zeros([0, 2])
-            for x1, x2, lh, gl, n in zip(self.x1,
-                                         self.x2,
-                                         likelihood,
-                                         self.iteration,
-                                         N_per_grid_point):
+            for x1, x2, gl, n in zip(self.x1,
+                                     self.x2,
+                                     self.iteration,
+                                     N_per_grid_point):
                 samples = np.concatenate([
                     samples,
                     np.random.multivariate_normal([x1, x2], cov[gl], n)
                     ])
             x1, x2 = samples.T
 
             # Mask out the samples outside the region of interest
```

### Comparing `read_rapidpe-0.5.8/read_rapidpe/transform.py` & `read_rapidpe-0.5.9/read_rapidpe/transform.py`

 * *Files identical despite different names*

### Comparing `read_rapidpe-0.5.8/PKG-INFO` & `read_rapidpe-0.5.9/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: read-rapidpe
-Version: 0.5.8
+Version: 0.5.9
 Summary: Read and analyse results generated by rapidpe-rift-pipe
 Home-page: https://github.com/c0rychu/read-rapidpe
 Author: Cory Chu
 Author-email: cory@gwlab.page
 Requires-Python: >=3.8,<4.0
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.8
```

