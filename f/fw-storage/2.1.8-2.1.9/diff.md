# Comparing `tmp/fw_storage-2.1.8-py3-none-any.whl.zip` & `tmp/fw_storage-2.1.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,26 +1,26 @@
-Zip file size: 37981 bytes, number of entries: 24
+Zip file size: 38154 bytes, number of entries: 24
 -rw-r--r--  2.0 unx      511 b- defN 80-Jan-01 00:00 fw_storage/__init__.py
 -rw-r--r--  2.0 unx    18182 b- defN 80-Jan-01 00:00 fw_storage/config.py
 -rw-r--r--  2.0 unx      113 b- defN 80-Jan-01 00:00 fw_storage/errors.py
--rw-r--r--  2.0 unx     1676 b- defN 80-Jan-01 00:00 fw_storage/fileinfo.py
+-rw-r--r--  2.0 unx     1737 b- defN 80-Jan-01 00:00 fw_storage/fileinfo.py
 -rw-r--r--  2.0 unx     1016 b- defN 80-Jan-01 00:00 fw_storage/filters.py
 -rw-r--r--  2.0 unx     1013 b- defN 80-Jan-01 00:00 fw_storage/future/__init__.py
--rw-r--r--  2.0 unx    11816 b- defN 80-Jan-01 00:00 fw_storage/future/base.py
+-rw-r--r--  2.0 unx    11860 b- defN 80-Jan-01 00:00 fw_storage/future/base.py
 -rw-r--r--  2.0 unx     4652 b- defN 80-Jan-01 00:00 fw_storage/future/errors.py
 -rw-r--r--  2.0 unx       36 b- defN 80-Jan-01 00:00 fw_storage/future/types/__init__.py
--rw-r--r--  2.0 unx    12755 b- defN 80-Jan-01 00:00 fw_storage/future/types/fs.py
+-rw-r--r--  2.0 unx    13027 b- defN 80-Jan-01 00:00 fw_storage/future/types/fs.py
 -rw-r--r--  2.0 unx     3934 b- defN 80-Jan-01 00:00 fw_storage/future/utils.py
 -rw-r--r--  2.0 unx        0 b- defN 80-Jan-01 00:00 fw_storage/py.typed
 -rw-r--r--  2.0 unx     7611 b- defN 80-Jan-01 00:00 fw_storage/storage.py
 -rw-r--r--  2.0 unx       28 b- defN 80-Jan-01 00:00 fw_storage/types/__init__.py
--rw-r--r--  2.0 unx     6900 b- defN 80-Jan-01 00:00 fw_storage/types/az.py
--rw-r--r--  2.0 unx    13338 b- defN 80-Jan-01 00:00 fw_storage/types/dicom.py
+-rw-r--r--  2.0 unx     6950 b- defN 80-Jan-01 00:00 fw_storage/types/az.py
+-rw-r--r--  2.0 unx    13364 b- defN 80-Jan-01 00:00 fw_storage/types/dicom.py
 -rw-r--r--  2.0 unx     7996 b- defN 80-Jan-01 00:00 fw_storage/types/dicomweb.py
 -rw-r--r--  2.0 unx      140 b- defN 80-Jan-01 00:00 fw_storage/types/fs.py
--rw-r--r--  2.0 unx     4937 b- defN 80-Jan-01 00:00 fw_storage/types/gs.py
--rw-r--r--  2.0 unx     6450 b- defN 80-Jan-01 00:00 fw_storage/types/s3.py
--rw-r--r--  2.0 unx     1078 b- defN 80-Jan-01 00:00 fw_storage-2.1.8.dist-info/LICENSE
--rw-r--r--  2.0 unx     4013 b- defN 80-Jan-01 00:00 fw_storage-2.1.8.dist-info/METADATA
--rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 fw_storage-2.1.8.dist-info/WHEEL
-?rw-r--r--  2.0 unx     1925 b- defN 16-Jan-01 00:00 fw_storage-2.1.8.dist-info/RECORD
-24 files, 110208 bytes uncompressed, 34897 bytes compressed:  68.3%
+-rw-r--r--  2.0 unx     4987 b- defN 80-Jan-01 00:00 fw_storage/types/gs.py
+-rw-r--r--  2.0 unx     6504 b- defN 80-Jan-01 00:00 fw_storage/types/s3.py
+-rw-r--r--  2.0 unx     1078 b- defN 80-Jan-01 00:00 fw_storage-2.1.9.dist-info/LICENSE
+-rw-r--r--  2.0 unx     4013 b- defN 80-Jan-01 00:00 fw_storage-2.1.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       88 b- defN 80-Jan-01 00:00 fw_storage-2.1.9.dist-info/WHEEL
+?rw-r--r--  2.0 unx     1925 b- defN 16-Jan-01 00:00 fw_storage-2.1.9.dist-info/RECORD
+24 files, 110765 bytes uncompressed, 35070 bytes compressed:  68.3%
```

## zipnote {}

```diff
@@ -54,20 +54,20 @@
 
 Filename: fw_storage/types/gs.py
 Comment: 
 
 Filename: fw_storage/types/s3.py
 Comment: 
 
-Filename: fw_storage-2.1.8.dist-info/LICENSE
+Filename: fw_storage-2.1.9.dist-info/LICENSE
 Comment: 
 
-Filename: fw_storage-2.1.8.dist-info/METADATA
+Filename: fw_storage-2.1.9.dist-info/METADATA
 Comment: 
 
-Filename: fw_storage-2.1.8.dist-info/WHEEL
+Filename: fw_storage-2.1.9.dist-info/WHEEL
 Comment: 
 
-Filename: fw_storage-2.1.8.dist-info/RECORD
+Filename: fw_storage-2.1.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## fw_storage/fileinfo.py

```diff
@@ -8,16 +8,17 @@
 class FileInfo:
     """FileInfo dataclass yielded from storage.ls() calls.
 
     Path is unique and relative to the storage prefix. Slots minimize memory
     usage to allow storing large number of FileInfo instances at once.
     """
 
-    __slots__ = ("path", "size", "hash", "created", "modified")
+    __slots__ = ("type", "path", "size", "hash", "created", "modified")
 
+    type: t.Literal["fs", "s3", "gs", "az", "dicom"]
     path: str
     size: int
     hash: t.Optional[str]
     created: t.Optional[t.Union[int, float]]
     modified: t.Optional[t.Union[int, float]]
 
     def asdict(self) -> t.Dict:
```

## fw_storage/future/base.py

```diff
@@ -231,14 +231,15 @@
         with fw_utils.open_any(file) as rf, self.open(path, mode="w") as wf:
             shutil.copyfileobj(rf, wf)
 
 
 class File(Item):
     """File item with common attrs of files or blobs."""
 
+    type: t.Literal["fs", "s3", "gs", "az"]
     size: int
     ctime: t.Union[int, float, None]
     mtime: t.Union[int, float, None]
     hash: str
 
     @property
     def dir(self) -> str:
```

## fw_storage/future/types/fs.py

```diff
@@ -2,14 +2,15 @@
 import hashlib
 import os
 import re
 import shutil
 import typing as t
 from functools import cached_property
 from pathlib import Path
+from stat import S_IMODE
 
 from pydantic import BaseModel, Field, root_validator, validator
 
 from .. import errors, utils
 from ..base import AnyPath, Config, File, FileStorage, Mode
 
 ERRMAP: dict = {
@@ -151,14 +152,22 @@
     cleanup_dirs: bool = CopyField("cleanup_dirs")
     content_hash: bool = CopyField("content_hash")
     follow_links: bool = CopyField("follow_links")
     chown: t.Optional[str] = CopyField("chown")
     chmod: t.Optional[str] = CopyField("chmod")
 
 
+class FSFile(File):
+    """FS / local file-system file model."""
+
+    type: t.Literal["fs"] = "fs"
+    owner: str
+    perms: str
+
+
 class FSStorage(FileStorage):
     """FS / local file-system storage client."""
 
     def __init__(self, config: FSConfig) -> None:
         """Init FS / local file-system storage from a config."""
         self.config = config
         path = Path(config.path)
@@ -180,20 +189,20 @@
         """Return absolute file path, including the storage path."""
         return str(Path(self.config.path) / self.relpath(path))
 
     @errmap
     def ls(  # noqa: D417, PLR0913
         self,
         path: t.Optional[AnyPath] = None,
-        filt: t.Optional[t.Callable[[File], bool]] = None,
+        filt: t.Optional[t.Callable[[FSFile], bool]] = None,
         filt_dir: t.Optional[t.Callable[[str], bool]] = None,
         filt_file: t.Optional[t.Callable[[str], bool]] = None,
         follow_links: t.Optional[bool] = None,
         **kw,
-    ) -> t.Iterator[File]:
+    ) -> t.Iterator[FSFile]:
         """Yield sorted files, optionally filtered.
 
         Args:
             path: Path prefix / subdir to yield files from.
             filt: File filter callback for including/exluding by path, size, etc.
             filt_dir: Dirname filter callback for pruning the walk tree.
             filt_file: Filename filter callback for skipping stat() calls.
@@ -227,24 +236,26 @@
             # ie. stop yielding if a sibling dir should be walked first
             while rel_files and not (rel_dirs and rel_dirs[0] < rel_files[0]):
                 item = self.stat(rel_files.pop(0))
                 if filt(item):
                     yield item
 
     @errmap
-    def stat(self, path: AnyPath) -> File:
+    def stat(self, path: AnyPath) -> FSFile:
         """Return file stat from an str or Path."""
         path = Path(self.abspath(path))
         stat = path.stat()
-        return File(
+        return FSFile(
             path=self.relpath(path),
             size=stat.st_size,
             ctime=stat.st_ctime,
             mtime=stat.st_mtime,
             hash=md5sum(path, stat, self.config.content_hash),
+            owner=f"{stat.st_gid}:{stat.st_uid}",
+            perms=oct(S_IMODE(path.stat().st_mode))[-3:],
         )
 
     @errmap
     def open(self, path: AnyPath, mode: Mode = "r") -> t.BinaryIO:
         """Return a file opened for reading or writing."""
         path = Path(self.abspath(path))
         if mode == "w":
```

## fw_storage/types/az.py

```diff
@@ -137,14 +137,15 @@
     ) -> t.Iterator[FileInfo]:
         """Yield each item under prefix matching the include/exclude filters."""
         path = self.abspath(path)
         filt = StorageFilter(include=include, exclude=exclude)
         for blob in self.client.list_blobs(name_starts_with=path):
             relpath = re.sub(rf"^{self.config.prefix}", "", blob.name).lstrip("/")
             info = FileInfo(
+                type="az",
                 path=relpath,
                 size=blob.size,
                 hash=blob.etag,
                 created=blob.creation_time.timestamp(),
                 modified=blob.last_modified.timestamp(),
             )
             # skip az "folders" - path is empty if the prefix itself is a "folder"
@@ -155,14 +156,15 @@
 
     @errmap
     def stat(self, path: AnyPath) -> FileInfo:
         """Return FileInfo for a single file."""
         blob_client = self.client.get_blob_client(self.abspath(path))
         blob = blob_client.get_blob_properties()
         return FileInfo(
+            type="az",
             path=str(path),
             size=blob.size,
             hash=blob.etag,
             created=blob.creation_time.timestamp(),
             modified=blob.last_modified.timestamp(),
         )
```

## fw_storage/types/dicom.py

```diff
@@ -59,14 +59,15 @@
         size = ds.get("NumberOfSeriesRelatedInstances", 0)
         dt = get_timestamp(t.cast(dict, ds), "Series")
         if dt:
             timestamp = dt.replace(tzinfo=timezone.utc).timestamp()
         else:
             timestamp = datetime.utcnow().timestamp()
         return FileInfo(
+            type="dicom",
             path=f"{study_uid}/{series_uid}",
             size=size,
             hash=None,  # TODO figure out what to use
             created=timestamp,
             modified=timestamp,
         )
```

## fw_storage/types/gs.py

```diff
@@ -76,14 +76,15 @@
         filt = StorageFilter(include=include, exclude=exclude)
         prefix = f"{self.config.prefix}/{path}".strip("/")
         if prefix:
             prefix += "/"
         for blob in self.client.list_blobs(self.config.bucket, prefix=prefix):
             relpath = re.sub(rf"^{self.config.prefix}", "", blob.name).lstrip("/")
             info = FileInfo(
+                type="gs",
                 path=relpath,
                 size=blob.size,
                 hash=blob.etag,
                 created=blob.time_created.timestamp(),
                 modified=blob.updated.timestamp(),
             )
             # skip gs "folders" - path is empty if the prefix itself is a "folder"
@@ -94,14 +95,15 @@
 
     @errmap
     def stat(self, path: AnyPath) -> FileInfo:
         """Return FileInfo for a single file."""
         blob = self.client.bucket(self.config.bucket).blob(self.abspath(path))
         blob.reload()
         return FileInfo(
+            type="gs",
             path=str(path),
             size=blob.size,
             hash=blob.etag,
             created=blob.time_created.timestamp(),
             modified=blob.updated.timestamp(),
         )
```

## fw_storage/types/s3.py

```diff
@@ -102,14 +102,15 @@
             prefix += "/"
         pages = paginator.paginate(Bucket=self.config.bucket, Prefix=prefix)
         for page in pages:
             for meta in page.get("Contents", []):
                 filepath: str = meta["Key"]
                 relpath = re.sub(rf"^{self.config.prefix}", "", filepath).lstrip("/")
                 info = FileInfo(
+                    type="s3",
                     path=relpath,
                     size=meta["Size"],
                     hash=meta["ETag"][1:-1],
                     created=meta["LastModified"].timestamp(),  # TODO consider None
                     modified=meta["LastModified"].timestamp(),
                 )
                 # skip s3 "folders" - path is empty if the prefix itself is a "folder"
@@ -121,14 +122,15 @@
     @errmap
     def stat(self, path: AnyPath) -> FileInfo:
         """Return FileInfo for a single file."""
         meta = self.client.head_object(
             Bucket=self.config.bucket, Key=self.abspath(path)
         )
         return FileInfo(
+            type="s3",
             path=str(path),
             size=meta["ContentLength"],
             hash=meta["ETag"][1:-1],
             created=meta["LastModified"].timestamp(),  # TODO consider None
             modified=meta["LastModified"].timestamp(),
         )
```

## Comparing `fw_storage-2.1.8.dist-info/LICENSE` & `fw_storage-2.1.9.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `fw_storage-2.1.8.dist-info/METADATA` & `fw_storage-2.1.9.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fw-storage
-Version: 2.1.8
+Version: 2.1.9
 Summary: Unified storage interface.
 Home-page: https://gitlab.com/flywheel-io/tools/lib/fw-storage
 License: MIT
 Keywords: Flywheel,file,object,storage
 Author: Flywheel
 Author-email: support@flywheel.io
 Requires-Python: >=3.8,<4.0
```

## Comparing `fw_storage-2.1.8.dist-info/RECORD` & `fw_storage-2.1.9.dist-info/RECORD`

 * *Files 21% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 fw_storage/__init__.py,sha256=v36QDeDLZJv7Sj2zXEZ6s0YIxuz42A9OA8boUEFnPvk,511
 fw_storage/config.py,sha256=VNKq8MNQ4dudrJqU6tBmEx8s5kmOdqKhliFvnvncx_s,18182
 fw_storage/errors.py,sha256=HD92V9ebpmsILbhf239XRSmwmO_-WHiOEuYdCUnL1V4,113
-fw_storage/fileinfo.py,sha256=dukS4wGSyy-uH_OmFNYViCnrTY_agPldoYs8wUuyTIo,1676
+fw_storage/fileinfo.py,sha256=b2ZT8BBPm9Gppa-8R_UqmkUbxDdCnY5Fowrz6n71qHw,1737
 fw_storage/filters.py,sha256=P3C1oGw1q6UoNEbHiSr-xdi_jumosSKOQgsulZ2GGaA,1016
 fw_storage/future/__init__.py,sha256=TWyZ7CFeCDO4_uiiT6gLJhE-SP8Ie7bNsCB3vUSbv2U,1013
-fw_storage/future/base.py,sha256=GsXb5vvvmm1iSn9ErM_djNjSKEbsIeqzCxw39m96lDo,11816
+fw_storage/future/base.py,sha256=UGl2BFhRCtJb-LZF3z3ayEX4nh1hDpkZNOhRbaIivpc,11860
 fw_storage/future/errors.py,sha256=tE-wb4n_X8-v2zaU5KpoPlQVfDaDhazOpjLmNU45cw0,4652
 fw_storage/future/types/__init__.py,sha256=zOnfjDtMpINsVdYFikGbvjIf_FVnfPpm-DanhqDrLjo,36
-fw_storage/future/types/fs.py,sha256=xxs7p7Q6AQRwPALAg5Ds386yHh9k2cDe1HFtLKKrUWo,12755
+fw_storage/future/types/fs.py,sha256=-9V9_2oDzv82g250JqinRX3OBmoC6gfrEncxgIOLI8g,13027
 fw_storage/future/utils.py,sha256=JLVhxqSsA0uyNMbhPKyEQoJ3FVYoqLyjyO3bfeO4OOk,3934
 fw_storage/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 fw_storage/storage.py,sha256=1_KqVCRUzINhERpSygBNvZhdvIzYBw7V6FWk13DKJqA,7611
 fw_storage/types/__init__.py,sha256=TT2pfyY-AMuKb4FZduNbVbmWTBRyEC3autb1QbdHE24,28
-fw_storage/types/az.py,sha256=hRSvvPZQlVkBGMNtgKNJfcnrEDVDgXUah-aAZKzD6Aw,6900
-fw_storage/types/dicom.py,sha256=XUSFsdSGTyNb8a6-K2H0jvztzj5lT5FmuGHt8pi_SCI,13338
+fw_storage/types/az.py,sha256=gv1dt_MWZNwUCxxAiiF9KHnlw6vhMNFIu85UtPyNnsQ,6950
+fw_storage/types/dicom.py,sha256=yMMmvV6PLuCkRORzgwVmS5u67PNsgw3LXE6PAvRRSfw,13364
 fw_storage/types/dicomweb.py,sha256=NR9E-csPgznASouwIdokukAxGPKCPRobhz80e4-z_v0,7996
 fw_storage/types/fs.py,sha256=Cz_GGrS_e11m9SvDgdjJkMf-VMI0s5DKUJZp0bWSegM,140
-fw_storage/types/gs.py,sha256=9J0QOH_Ty7QoMeZ6BkaZNGQw3f8LNgdKjz9DmBg8PsU,4937
-fw_storage/types/s3.py,sha256=RomRY4TFZzcvwuF5hemxsQfODuHFDAQcensmocy_0sc,6450
-fw_storage-2.1.8.dist-info/LICENSE,sha256=3QLwoJgDkLWRKwcyYzPn3vLqTHhbdltfjFYeBOZSlDY,1078
-fw_storage-2.1.8.dist-info/METADATA,sha256=xvsGrHg1cxAG2r3BwekK3OQJiTdYLeVCm--V1YRyOK0,4013
-fw_storage-2.1.8.dist-info/WHEEL,sha256=7Z8_27uaHI_UZAc4Uox4PpBhQ9Y5_modZXWMxtUi4NU,88
-fw_storage-2.1.8.dist-info/RECORD,,
+fw_storage/types/gs.py,sha256=p4rVPsNgaVW4RStFvrrEM3BtNS6xcDBXNnIWFbT7lKA,4987
+fw_storage/types/s3.py,sha256=JNkvaidHR9hCYB1m859Bd8e7fqbkqLxAFa3Skmc3Plg,6504
+fw_storage-2.1.9.dist-info/LICENSE,sha256=3QLwoJgDkLWRKwcyYzPn3vLqTHhbdltfjFYeBOZSlDY,1078
+fw_storage-2.1.9.dist-info/METADATA,sha256=onJLN7q3RDgfYoJi9BrXWoJxaq_NuyrlGFbcaE_LVb4,4013
+fw_storage-2.1.9.dist-info/WHEEL,sha256=7Z8_27uaHI_UZAc4Uox4PpBhQ9Y5_modZXWMxtUi4NU,88
+fw_storage-2.1.9.dist-info/RECORD,,
```

