# Comparing `tmp/dataone.libclient-3.5.0-py3-none-any.whl.zip` & `tmp/dataone.libclient-3.5.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,62 +1,62 @@
-Zip file size: 101369 bytes, number of entries: 60
--rw-rw-r--  2.0 unx     1779 b- defN 20-Aug-03 03:55 d1_client/__init__.py
--rw-rw-r--  2.0 unx    25978 b- defN 20-Aug-03 03:55 d1_client/baseclient.py
--rw-rw-r--  2.0 unx     5193 b- defN 20-Aug-03 03:55 d1_client/baseclient_1_1.py
--rw-rw-r--  2.0 unx     2092 b- defN 20-Aug-03 03:55 d1_client/baseclient_1_2.py
--rw-rw-r--  2.0 unx     2856 b- defN 20-Aug-03 03:55 d1_client/baseclient_2_0.py
--rw-rw-r--  2.0 unx    33311 b- defN 20-Aug-03 03:55 d1_client/cnclient.py
--rw-rw-r--  2.0 unx     1787 b- defN 20-Aug-03 03:55 d1_client/cnclient_1_1.py
--rw-rw-r--  2.0 unx     1787 b- defN 20-Aug-03 03:55 d1_client/cnclient_1_2.py
--rw-rw-r--  2.0 unx     6224 b- defN 20-Aug-03 03:55 d1_client/cnclient_2_0.py
--rw-rw-r--  2.0 unx    10249 b- defN 20-Aug-03 03:55 d1_client/command_line.py
--rw-rw-r--  2.0 unx     6913 b- defN 20-Aug-03 03:55 d1_client/d1client.py
--rw-rw-r--  2.0 unx     8348 b- defN 20-Aug-03 03:55 d1_client/mnclient.py
--rw-rw-r--  2.0 unx     1769 b- defN 20-Aug-03 03:55 d1_client/mnclient_1_1.py
--rw-rw-r--  2.0 unx     3410 b- defN 20-Aug-03 03:55 d1_client/mnclient_1_2.py
--rw-rw-r--  2.0 unx     1790 b- defN 20-Aug-03 03:55 d1_client/mnclient_2_0.py
--rw-rw-r--  2.0 unx    18409 b- defN 20-Aug-03 03:55 d1_client/session.py
--rw-rw-r--  2.0 unx    31502 b- defN 20-Aug-03 03:55 d1_client/solr_client.py
--rw-rw-r--  2.0 unx     1643 b- defN 20-Aug-03 03:55 d1_client/util.py
--rw-rw-r--  2.0 unx     1029 b- defN 20-Aug-03 03:55 d1_client/aio/__init__.py
--rw-rw-r--  2.0 unx    11024 b- defN 20-Aug-03 03:55 d1_client/aio/async_client.py
--rw-rw-r--  2.0 unx     4266 b- defN 20-Aug-03 03:55 d1_client/aio/command_line.py
--rw-rw-r--  2.0 unx     3615 b- defN 20-Aug-03 03:55 d1_client/aio/util.py
--rw-rw-r--  2.0 unx     1449 b- defN 20-Aug-03 03:55 d1_client/aio/iter/__init__.py
--rw-rw-r--  2.0 unx     4939 b- defN 20-Aug-03 03:55 d1_client/aio/iter/base_async.py
--rw-rw-r--  2.0 unx     2800 b- defN 20-Aug-03 03:55 d1_client/aio/iter/eventlog_async.py
--rw-rw-r--  2.0 unx     2568 b- defN 20-Aug-03 03:55 d1_client/aio/iter/eventlog_cmd.py
--rw-rw-r--  2.0 unx     2838 b- defN 20-Aug-03 03:55 d1_client/aio/iter/objectlist_async.py
--rw-rw-r--  2.0 unx     2570 b- defN 20-Aug-03 03:55 d1_client/aio/iter/objectlist_cmd.py
--rw-rw-r--  2.0 unx      858 b- defN 20-Aug-03 03:55 d1_client/aio/iter/test.py
--rw-rw-r--  2.0 unx     1324 b- defN 20-Aug-03 03:55 d1_client/iter/__init__.py
--rw-rw-r--  2.0 unx     7674 b- defN 20-Aug-03 03:55 d1_client/iter/base_multi.py
--rw-rw-r--  2.0 unx     3891 b- defN 20-Aug-03 03:55 d1_client/iter/logrecord.py
--rw-rw-r--  2.0 unx     2200 b- defN 20-Aug-03 03:55 d1_client/iter/logrecord_multi.py
--rw-rw-r--  2.0 unx     1566 b- defN 20-Aug-03 03:55 d1_client/iter/node.py
--rw-rw-r--  2.0 unx     4376 b- defN 20-Aug-03 03:55 d1_client/iter/objectlist.py
--rw-rw-r--  2.0 unx     2276 b- defN 20-Aug-03 03:55 d1_client/iter/objectlist_multi.py
--rw-rw-r--  2.0 unx     2823 b- defN 20-Aug-03 03:55 d1_client/iter/sysmeta_multi.py
--rw-rw-r--  2.0 unx      788 b- defN 20-Aug-03 03:55 d1_client/tests/__init__.py
--rw-rw-r--  2.0 unx      936 b- defN 20-Aug-03 03:55 d1_client/tests/shared_context.py
--rw-rw-r--  2.0 unx    10257 b- defN 20-Aug-03 03:55 d1_client/tests/test_baseclient_1_0.py
--rw-rw-r--  2.0 unx     2708 b- defN 20-Aug-03 03:55 d1_client/tests/test_baseclient_1_1.py
--rw-rw-r--  2.0 unx      915 b- defN 20-Aug-03 03:55 d1_client/tests/test_baseclient_2_0.py
--rw-rw-r--  2.0 unx    33309 b- defN 20-Aug-03 03:55 d1_client/tests/test_cnclient_1_0.py
--rw-rw-r--  2.0 unx     1494 b- defN 20-Aug-03 03:55 d1_client/tests/test_cnclient_1_1.py
--rw-rw-r--  2.0 unx     6166 b- defN 20-Aug-10 05:14 d1_client/tests/test_cnclient_2_0.py
--rw-rw-r--  2.0 unx     2988 b- defN 20-Aug-03 03:55 d1_client/tests/test_d1client.py
--rw-rw-r--  2.0 unx     3117 b- defN 20-Aug-03 03:55 d1_client/tests/test_iter_log_record.py
--rw-rw-r--  2.0 unx     2837 b- defN 20-Aug-03 03:55 d1_client/tests/test_iter_log_record_multi.py
--rw-rw-r--  2.0 unx     2379 b- defN 20-Aug-03 03:55 d1_client/tests/test_iter_object_list_multi.py
--rw-rw-r--  2.0 unx     4132 b- defN 20-Aug-03 03:55 d1_client/tests/test_iter_sysmeta_multi.py
--rw-rw-r--  2.0 unx     2511 b- defN 20-Aug-03 03:55 d1_client/tests/test_mnclient_1_0.py
--rw-rw-r--  2.0 unx      908 b- defN 20-Aug-03 03:55 d1_client/tests/test_mnclient_1_1.py
--rw-rw-r--  2.0 unx     2215 b- defN 20-Aug-03 03:55 d1_client/tests/test_mnclient_2_0.py
--rw-rw-r--  2.0 unx     5850 b- defN 20-Aug-03 03:55 d1_client/tests/test_session.py
--rw-rw-r--  2.0 unx     7330 b- defN 20-Aug-03 03:55 d1_client/tests/test_solr_client.py
--rw-rw-r--  2.0 unx     1880 b- defN 20-Aug-03 03:55 d1_client/tests/test_util.py
--rw-rw-r--  2.0 unx      851 b- defN 20-Aug-10 05:53 dataone.libclient-3.5.0.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 20-Aug-10 05:53 dataone.libclient-3.5.0.dist-info/WHEEL
--rw-rw-r--  2.0 unx       10 b- defN 20-Aug-10 05:53 dataone.libclient-3.5.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     5209 b- defN 20-Aug-10 05:53 dataone.libclient-3.5.0.dist-info/RECORD
-60 files, 328008 bytes uncompressed, 93097 bytes compressed:  71.6%
+Zip file size: 102097 bytes, number of entries: 60
+-rw-rw-r--  2.0 unx     1779 b- defN 23-Jun-05 20:06 d1_client/__init__.py
+-rw-rw-r--  2.0 unx    26014 b- defN 23-Jun-05 20:06 d1_client/baseclient.py
+-rw-rw-r--  2.0 unx     5193 b- defN 23-Jun-05 20:06 d1_client/baseclient_1_1.py
+-rw-rw-r--  2.0 unx     2092 b- defN 23-Jun-05 20:06 d1_client/baseclient_1_2.py
+-rw-rw-r--  2.0 unx     2856 b- defN 23-Jun-05 20:06 d1_client/baseclient_2_0.py
+-rw-rw-r--  2.0 unx    33311 b- defN 23-Jun-05 20:06 d1_client/cnclient.py
+-rw-rw-r--  2.0 unx     1787 b- defN 23-Jun-05 20:06 d1_client/cnclient_1_1.py
+-rw-rw-r--  2.0 unx     1787 b- defN 23-Jun-05 20:06 d1_client/cnclient_1_2.py
+-rw-rw-r--  2.0 unx     6224 b- defN 23-Jun-05 20:06 d1_client/cnclient_2_0.py
+-rw-rw-r--  2.0 unx    10249 b- defN 23-Jun-05 20:06 d1_client/command_line.py
+-rw-rw-r--  2.0 unx     6913 b- defN 23-Jun-05 20:06 d1_client/d1client.py
+-rw-rw-r--  2.0 unx     8348 b- defN 23-Jun-05 20:06 d1_client/mnclient.py
+-rw-rw-r--  2.0 unx     1769 b- defN 23-Jun-05 20:06 d1_client/mnclient_1_1.py
+-rw-rw-r--  2.0 unx     3410 b- defN 23-Jun-05 20:06 d1_client/mnclient_1_2.py
+-rw-rw-r--  2.0 unx     1790 b- defN 23-Jun-05 20:06 d1_client/mnclient_2_0.py
+-rw-rw-r--  2.0 unx    19006 b- defN 23-Jun-05 20:06 d1_client/session.py
+-rw-rw-r--  2.0 unx    31502 b- defN 23-Jun-05 20:06 d1_client/solr_client.py
+-rw-rw-r--  2.0 unx     1643 b- defN 23-Jun-05 20:06 d1_client/util.py
+-rw-rw-r--  2.0 unx     1029 b- defN 23-Jun-05 20:06 d1_client/aio/__init__.py
+-rw-rw-r--  2.0 unx    11024 b- defN 23-Jun-05 20:06 d1_client/aio/async_client.py
+-rw-rw-r--  2.0 unx     4266 b- defN 23-Jun-05 20:06 d1_client/aio/command_line.py
+-rw-rw-r--  2.0 unx     3615 b- defN 23-Jun-05 20:06 d1_client/aio/util.py
+-rw-rw-r--  2.0 unx     1449 b- defN 23-Jun-05 20:06 d1_client/aio/iter/__init__.py
+-rw-rw-r--  2.0 unx     4939 b- defN 23-Jun-05 20:06 d1_client/aio/iter/base_async.py
+-rw-rw-r--  2.0 unx     2800 b- defN 23-Jun-05 20:06 d1_client/aio/iter/eventlog_async.py
+-rw-rw-r--  2.0 unx     2568 b- defN 23-Jun-05 20:06 d1_client/aio/iter/eventlog_cmd.py
+-rw-rw-r--  2.0 unx     2838 b- defN 23-Jun-05 20:06 d1_client/aio/iter/objectlist_async.py
+-rw-rw-r--  2.0 unx     2570 b- defN 23-Jun-05 20:06 d1_client/aio/iter/objectlist_cmd.py
+-rw-rw-r--  2.0 unx      858 b- defN 23-Jun-05 20:06 d1_client/aio/iter/test.py
+-rw-rw-r--  2.0 unx     1324 b- defN 23-Jun-05 20:06 d1_client/iter/__init__.py
+-rw-rw-r--  2.0 unx     7851 b- defN 23-Jun-05 20:06 d1_client/iter/base_multi.py
+-rw-rw-r--  2.0 unx     3891 b- defN 23-Jun-05 20:06 d1_client/iter/logrecord.py
+-rw-rw-r--  2.0 unx     2200 b- defN 23-Jun-05 20:06 d1_client/iter/logrecord_multi.py
+-rw-rw-r--  2.0 unx     1566 b- defN 23-Jun-05 20:06 d1_client/iter/node.py
+-rw-rw-r--  2.0 unx     4376 b- defN 23-Jun-05 20:06 d1_client/iter/objectlist.py
+-rw-rw-r--  2.0 unx     2276 b- defN 23-Jun-05 20:06 d1_client/iter/objectlist_multi.py
+-rw-rw-r--  2.0 unx     2839 b- defN 23-Jun-05 20:06 d1_client/iter/sysmeta_multi.py
+-rw-rw-r--  2.0 unx      788 b- defN 23-Jun-05 20:06 d1_client/tests/__init__.py
+-rw-rw-r--  2.0 unx      936 b- defN 23-Jun-05 20:06 d1_client/tests/shared_context.py
+-rw-rw-r--  2.0 unx    10257 b- defN 23-Jun-05 20:06 d1_client/tests/test_baseclient_1_0.py
+-rw-rw-r--  2.0 unx     2708 b- defN 23-Jun-05 20:06 d1_client/tests/test_baseclient_1_1.py
+-rw-rw-r--  2.0 unx      915 b- defN 23-Jun-05 20:06 d1_client/tests/test_baseclient_2_0.py
+-rw-rw-r--  2.0 unx    33309 b- defN 23-Jun-05 20:06 d1_client/tests/test_cnclient_1_0.py
+-rw-rw-r--  2.0 unx     1494 b- defN 23-Jun-05 20:06 d1_client/tests/test_cnclient_1_1.py
+-rw-rw-r--  2.0 unx     6166 b- defN 23-Jun-05 20:06 d1_client/tests/test_cnclient_2_0.py
+-rw-rw-r--  2.0 unx     2988 b- defN 23-Jun-05 20:06 d1_client/tests/test_d1client.py
+-rw-rw-r--  2.0 unx     3117 b- defN 23-Jun-05 20:06 d1_client/tests/test_iter_log_record.py
+-rw-rw-r--  2.0 unx     2866 b- defN 23-Jun-05 20:06 d1_client/tests/test_iter_log_record_multi.py
+-rw-rw-r--  2.0 unx     2358 b- defN 23-Jun-05 20:06 d1_client/tests/test_iter_object_list_multi.py
+-rw-rw-r--  2.0 unx     4933 b- defN 23-Jun-05 20:06 d1_client/tests/test_iter_sysmeta_multi.py
+-rw-rw-r--  2.0 unx     2511 b- defN 23-Jun-05 20:06 d1_client/tests/test_mnclient_1_0.py
+-rw-rw-r--  2.0 unx      908 b- defN 23-Jun-05 20:06 d1_client/tests/test_mnclient_1_1.py
+-rw-rw-r--  2.0 unx     2215 b- defN 23-Jun-05 20:06 d1_client/tests/test_mnclient_2_0.py
+-rw-rw-r--  2.0 unx     5850 b- defN 23-Jun-05 20:06 d1_client/tests/test_session.py
+-rw-rw-r--  2.0 unx     7330 b- defN 23-Jun-05 20:06 d1_client/tests/test_solr_client.py
+-rw-rw-r--  2.0 unx     1880 b- defN 23-Jun-05 20:06 d1_client/tests/test_util.py
+-rw-rw-r--  2.0 unx      827 b- defN 23-Jun-05 20:26 dataone.libclient-3.5.2.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Jun-05 20:26 dataone.libclient-3.5.2.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       10 b- defN 23-Jun-05 20:26 dataone.libclient-3.5.2.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     5209 b- defN 23-Jun-05 20:26 dataone.libclient-3.5.2.dist-info/RECORD
+60 files, 329619 bytes uncompressed, 93825 bytes compressed:  71.5%
```

## zipnote {}

```diff
@@ -162,20 +162,20 @@
 
 Filename: d1_client/tests/test_solr_client.py
 Comment: 
 
 Filename: d1_client/tests/test_util.py
 Comment: 
 
-Filename: dataone.libclient-3.5.0.dist-info/METADATA
+Filename: dataone.libclient-3.5.2.dist-info/METADATA
 Comment: 
 
-Filename: dataone.libclient-3.5.0.dist-info/WHEEL
+Filename: dataone.libclient-3.5.2.dist-info/WHEEL
 Comment: 
 
-Filename: dataone.libclient-3.5.0.dist-info/top_level.txt
+Filename: dataone.libclient-3.5.2.dist-info/top_level.txt
 Comment: 
 
-Filename: dataone.libclient-3.5.0.dist-info/RECORD
+Filename: dataone.libclient-3.5.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## d1_client/baseclient.py

```diff
@@ -371,15 +371,15 @@
     def _read_stream_response(self, response):
         if self._status_is_200_ok(response):
             return response
         self._raise_exception(response)
 
     def _read_header_response(self, response):
         if self._status_is_200_ok(response):
-            self._read_response_to_content(response)
+            # There is no body to read in a HEAD request, so we return only the headers.
             return response.headers
         raise d1_common.types.exceptions.deserialize_from_headers(response.headers)
 
     def _read_response_to_content(self, response):
         # noinspection PyStatementEffect
         response.content
```

## d1_client/session.py

```diff
@@ -362,14 +362,23 @@
         url = self._prep_url(rest_path_list)
         kwargs = self._prep_request_kwargs(kwargs)
         self._log.debug(
             "Request equivalent: {}".format(
                 self.get_curl_command_line(method, url, **kwargs)
             )
         )
+        # This is a workaround for Requests attempting to buffer the non-existing body
+        # of a HEAD request. We want HEAD requests to include the Content-Length header,
+        # with length of the bytes that would be included in a GET request. But Requests
+        # ends up attempting to buffer the number of bytes declared by the
+        # Content-Length even in HEAD requests. With stream=True, Requests does not
+        # attempt to read the bytes automatically, expecting them to be read by the
+        # user.
+        if method.lower() == 'head':
+            kwargs['stream'] = True
         return self._session.request(method, url, **kwargs)
 
     def _prep_url(self, rest_path_list):
         if isinstance(rest_path_list, str):
             rest_path_list = [rest_path_list]
         return d1_common.url.joinPathElements(
             self._base_url,
```

## d1_client/iter/base_multi.py

```diff
@@ -11,25 +11,25 @@
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-"""Base for multiprocessed iterator of DataONE types."""
+
+"""Base for multiprocessing iterator of DataONE types."""
 
 import logging
 import multiprocessing
 import time
 
-import d1_common.const
-import d1_common.types.exceptions
-
 import d1_client.mnclient_1_2
 import d1_client.mnclient_2_0
+import d1_common.const
+import d1_common.types.exceptions
 
 # Defaults
 PAGE_SIZE = 1000
 MAX_WORKERS = 16
 # See notes in module docstring for SysMeta iterator before changing
 MAX_RESULT_QUEUE_SIZE = 100
 MAX_TASK_QUEUE_SIZE = 16
@@ -121,56 +121,56 @@
 
 
 def _get_all_pages(
     queue, namespace, base_url, page_size, max_workers, max_task_queue_size, api_major,
     client_arg_dict, page_arg_dict, item_proc_arg_dict, page_func, iter_func, item_proc_func, n_total
 ):
     logger.debug("Creating pool of {} workers".format(max_workers))
-    pool = multiprocessing.Pool(processes=max_workers)
+
     n_pages = (n_total - 1) // page_size + 1
 
-    for page_idx in range(n_pages):
-        if namespace.stop:
-            logger.debug("Received stop signal")
-            break
-        try:
-            pool.apply_async(
-                _get_page,
-                args=(
-                    queue, namespace, base_url, page_idx, n_pages, page_size, api_major,
-                    client_arg_dict, page_arg_dict, item_proc_arg_dict, page_func,
-                    iter_func, item_proc_func
-                ),
-            )
-        except Exception as e:
-            logger.debug('Continuing after exception. error="{}"'.format(str(e)))
-        # The pool does not support a clean way to limit the number of queued tasks
-        # so we have to access the internals to check the queue size and wait if
-        # necessary.
-        while pool._taskqueue.qsize() > max_task_queue_size:
+    # See test_iter_sysmeta_multi.py for notes on 'spawn'.
+    with multiprocessing.get_context('spawn').Pool(processes=max_workers) as pool:
+        for page_idx in range(n_pages):
             if namespace.stop:
                 logger.debug("Received stop signal")
                 break
-            # logger.debug('_get_all_pages(): Waiting to queue task')
-            time.sleep(1)
+            try:
+                pool.apply_async(
+                    _get_page,
+                    args=(
+                        queue, namespace, base_url, page_idx, n_pages, page_size, api_major,
+                        client_arg_dict, page_arg_dict, item_proc_arg_dict, page_func,
+                        iter_func, item_proc_func
+                    ),
+                )
+            except Exception as e:
+                logger.debug('Continuing after exception. error="{}"'.format(str(e)))
+            # The pool does not support a clean way to limit the number of queued tasks
+            # so we have to access the internals to check the queue size and wait if
+            # necessary.
+            while pool._taskqueue.qsize() > max_task_queue_size:
+                if namespace.stop:
+                    logger.debug("Received stop signal")
+                    break
+                logger.debug('_get_all_pages(): Waiting to queue task')
+                time.sleep(1)
 
-    # Workaround for workers hanging at exit.
-    # pool.terminate()
-    logger.debug("Preventing more tasks for being added to the pool")
-    pool.close()
-    logger.debug("Waiting for the workers to exit")
-    pool.join()
     logger.debug("Sending None sentinel value to stop the generator")
     queue.put(None)
 
 
 def _get_page(
     queue, namespace, base_url, page_idx, n_pages, page_size, api_major,
     client_arg_dict, page_arg_dict, item_proc_arg_dict, page_func, iter_func, item_proc_func
 ):
+    # Because the worker processes are spawned, they do not inherit the logging, so we
+    # have to configure logging here in order to see log messages from the workers.
+    logging.basicConfig(level=logging.WARNING)
+
     logger.debug("Processing page. page_idx={} n_pages={}".format(page_idx, n_pages))
 
     if namespace.stop:
         logger.debug("Received stop signal")
         return
 
     client = create_client(base_url, api_major, client_arg_dict)
@@ -199,14 +199,13 @@
         if namespace.stop:
             logger.debug("Received stop signal")
             break
         queue.put(item_proc_func(client, item_pyxb, item_proc_arg_dict))
 
     logger.debug("Completed page")
 
-
 def create_client(base_url=d1_common.const.URL_DATAONE_ROOT, api_major=2, client_arg_dict=None):
     client_arg_dict = client_arg_dict or {}
     if api_major in (1, "1", "v1"):
         return d1_client.mnclient_1_2.MemberNodeClient_1_2(base_url, **client_arg_dict)
     else:
         return d1_client.mnclient_2_0.MemberNodeClient_2_0(base_url, **client_arg_dict)
```

## d1_client/iter/sysmeta_multi.py

```diff
@@ -12,22 +12,22 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import logging
+# import logging
 
 import d1_common.const
 import d1_common.xml
 
 import d1_client.iter.base_multi
 
-logger = logging.getLogger(__name__)
+# logger = logging.getLogger(__name__)
 
 
 # fmt: off
 class SystemMetadataIteratorMulti(d1_client.iter.base_multi.MultiprocessedIteratorBase):
     # language=rst
     """Multiprocessed SystemMetadata Iterator.
 
@@ -62,17 +62,17 @@
 
 def _iter_func(page_pyxb):
     return page_pyxb.objectInfo
 
 
 def _item_proc_func(client, item_pyxb, get_system_metadata_arg_dict):
     pid = d1_common.xml.get_req_val(item_pyxb.identifier)
-    logger.debug('Retrieving System Metadata. pid="{}".format(pid)')
+    # logger.debug('Retrieving System Metadata. pid="{}"'.format(pid))
     try:
         return client.getSystemMetadata(pid, get_system_metadata_arg_dict)
     except Exception as e:
-        logger.error(
-            'Unable to retrieve System Metadata. pid="{}" error="{}"'.format(
-                pid, str(e)
-            )
-        )
-        return {"pid": pid, "error": e.name}
+        # logger.error(
+        #     'Unable to retrieve System Metadata. pid="{}" error="{}"'.format(
+        #         pid, str(e)
+        #     )
+        # )
+        return {"pid": pid, "error": str(e)}
```

## d1_client/tests/test_iter_log_record_multi.py

```diff
@@ -61,20 +61,20 @@
         self.sample.assert_equals(
             "\n".join(
                 d1_common.xml.serialize_to_xml_str(v) for v in log_entry_list[:5]
             ),
             "page_size_{}".format(page_size),
         )
 
-    @responses.activate
-    def test_1000(self):
-        """PageSize=5, no date filter."""
-        self._log_record_iterator_test(5)
-
-    @responses.activate
-    def test_1010(self):
-        """PageSize=100, from- and to-date filter."""
-        self._log_record_iterator_test(
-            100,
-            from_date=datetime.datetime(2005, 1, 1),
-            to_date=datetime.datetime(2006, 1, 1),
-        )
+    # @responses.activate
+    # def test_1000(self):
+    #     """PageSize=5, no date filter."""
+    #     self._log_record_iterator_test(5)
+    #
+    # @responses.activate
+    # def test_1010(self):
+    #     """PageSize=100, from- and to-date filter."""
+    #     self._log_record_iterator_test(
+    #         100,
+    #         from_date=datetime.datetime(2005, 1, 1),
+    #         to_date=datetime.datetime(2006, 1, 1),
+    #     )
```

## d1_client/tests/test_iter_object_list_multi.py

```diff
@@ -26,16 +26,17 @@
 
 import d1_client.d1client
 import d1_client.iter.objectlist_multi
 
 import d1_test.d1_test_case
 import d1_test.mock_api.list_objects
 
+import pytest
 
-# @pytest.mark.skipif(sys.version_info <= (3, 6), reason="Requires >= Python 3.7")
+@pytest.mark.skip('See comment at top of file')
 @d1_test.d1_test_case.reproducible_random_decorator("TestIterObjectListIterator")
 @freezegun.freeze_time("1945-06-01")
 class TestIterObjectListIterator(d1_test.d1_test_case.D1TestCase):
     @responses.activate
     def test_1000(self, mn_client_v1_v2):
         """Object List iteration."""
         d1_test.mock_api.list_objects.add_callback(
```

## d1_client/tests/test_iter_sysmeta_multi.py

```diff
@@ -13,51 +13,54 @@
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
+
+# By default, multiprocessing uses fork() on Linux and MacOS, which causes instabilities
+# due to stuck locks. This changes the default to 'spawn', which fixes the locking
+# issues, but causes other issues with testing. The main issue is that, with 'spawn',
+# the Responses mock endpoints set up by the test are not active in the child process,
+# so the child process fails because Requests attempts to access invalid URLs. There are
+# further issues with multiprocessing under pytest, including issues with
+# multiprocessing queues, and mocking done by freezegun and random_decorator(). This
+# leaves us without a stable way to automatically test the multiprocessing based
+# iterators, so these tests are disabled for now. It's probably best to test these
+# manually with regular scripts. The default multiprocessing start method will be
+# changed to 'spawn' in Python 3.12, but the pytest compatibility issues will probably
+# remain. See also: Why your multiprocessing Pool is stuck --
+# https://pythonspeed.com/articles/python-multiprocessing/
+import multiprocessing
+multiprocessing.set_start_method("spawn")
+
+import logging
 import freezegun
 import pytest
 import responses
 
+import d1_client.iter.sysmeta_multi
 import d1_common.date_time
 import d1_common.xml
-
-import d1_client.iter.sysmeta_multi
-
 import d1_test.d1_test_case
 import d1_test.mock_api.get_system_metadata
 import d1_test.mock_api.list_objects
 
 N_TOTAL = 50
 
 
-# @pytest.mark.skipif(sys.version_info <= (3, 6), reason="Requires >= Python 3.7")
+# noinspection PyTypeChecker,PyUnresolvedReferences
+@pytest.mark.skip('See comment at top of file')
 @d1_test.d1_test_case.reproducible_random_decorator("TestSysMetaIterator")
 @freezegun.freeze_time("1945-07-01")
 class TestSysMetaIterator(d1_test.d1_test_case.D1TestCase):
     """Run with misc variations and verify that they give the same result."""
-
-    # parameterize_dict = {
-    #     'test_1000': [
-    #         dict(
-    #             from_date=d1_common.date_time.create_utc_datetime(1990, 7, 20),
-    #             to_date=d1_common.date_time.create_utc_datetime(2010, 8, 20),
-    #         ),
-    #         dict(
-    #             from_date=d1_common.date_time.create_utc_datetime(1980, 8, 5),
-    #             to_date=None,
-    #         ),
-    #     ]
-    # }
-
     def _get_combined_xml(self, sysmeta_pyxb_list, n_total):
-        """When using multiple threads, docs are returned in random order, so we sort
+        """When using multiprocessing, docs are returned in random order, so we sort
         them and use the first and last few ones for checking."""
         sorted_list = sorted(sysmeta_pyxb_list, key=lambda x: x.identifier.value())
         return "\n".join(
             [
                 d1_common.xml.serialize_to_xml_str(p)
                 for p in (sorted_list[:2] + sorted_list[n_total - 2 :])
             ]
@@ -66,41 +69,44 @@
     @pytest.mark.parametrize(
         "from_date,to_date",
         [
             (
                 d1_common.date_time.create_utc_datetime(1990, 7, 20),
                 d1_common.date_time.create_utc_datetime(2010, 8, 20),
             ),
-            (d1_common.date_time.create_utc_datetime(1980, 8, 5), None),
+            (
+                d1_common.date_time.create_utc_datetime(1980, 8, 5),
+                None,
+            ),
         ],
     )
-    @pytest.mark.parametrize("page_size", [3, 44, 55])
-    @pytest.mark.parametrize("n_workers", [1, 5])
+    @pytest.mark.parametrize("page_size", [3, 55])
+    @pytest.mark.parametrize("n_workers", [1, 7])
     @responses.activate
     def test_1000(self, page_size, n_workers, from_date, to_date):
         d1_test.mock_api.list_objects.add_callback(
             d1_test.d1_test_case.MOCK_MN_BASE_URL, n_total=N_TOTAL
         )
         d1_test.mock_api.get_system_metadata.add_callback(
             d1_test.d1_test_case.MOCK_MN_BASE_URL
         )
         sysmeta_pyxb_list = []
-        # with freezegun.freeze_time('1977-07-27') as freeze_time:
         sysmeta_iter = d1_client.iter.sysmeta_multi.SystemMetadataIteratorMulti(
             d1_test.d1_test_case.MOCK_MN_BASE_URL,
             page_size=page_size,
             max_workers=n_workers,
             client_arg_dict={
                 # 'cert_pem_path': cert_pem_path,
                 # 'cert_key_path': cert_key_path,
             },
             list_objects_arg_dict={"fromDate": from_date, "toDate": to_date},
         )
 
         for sysmeta_pyxb in sysmeta_iter:
+            logging.debug('sysmeta_pyxb.identifier.value()="{}"'.format(sysmeta_pyxb.identifier.value()))
             # freeze_time.tick(delta=datetime.timedelta(days=1))
             sysmeta_pyxb_list.append(sysmeta_pyxb)
 
         combined_sysmeta_xml = self._get_combined_xml(sysmeta_pyxb_list, N_TOTAL)
 
         self.sample.assert_equals(
             combined_sysmeta_xml,
```

## Comparing `dataone.libclient-3.5.0.dist-info/METADATA` & `dataone.libclient-3.5.2.dist-info/METADATA`

 * *Files 22% similar despite different names*

```diff
@@ -1,25 +1,21 @@
 Metadata-Version: 2.1
 Name: dataone.libclient
-Version: 3.5.0
+Version: 3.5.2
 Summary: A DataONE client library for Python
 Home-page: https://github.com/DataONEorg/d1_python
 Author: DataONE Project
 Author-email: developers@dataone.org
 License: Apache License, Version 2.0
 Keywords: DataONE client upload download member-node coordinating-node
-Platform: UNKNOWN
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: Topic :: Scientific/Engineering
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Programming Language :: Python :: 3
 Classifier: Programming Language :: Python :: 3.7
-Requires-Dist: dataone.common (>=3.5.0)
-Requires-Dist: pyxb (>=1.2.6)
-Requires-Dist: requests-toolbelt (>=0.9.1)
-Requires-Dist: requests[security] (>=2.24.0)
-Requires-Dist: aiohttp (>=3.6.2)
-
-UNKNOWN
-
+Requires-Dist: dataone.common (>=3.5.2)
+Requires-Dist: pyxb-x (>=1.2.6.1)
+Requires-Dist: requests-toolbelt (>=1.0.0)
+Requires-Dist: requests[security] (>=2.31.0)
+Requires-Dist: aiohttp (>=3.8.4)
```

## Comparing `dataone.libclient-3.5.0.dist-info/RECORD` & `dataone.libclient-3.5.2.dist-info/RECORD`

 * *Files 5% similar despite different names*

```diff
@@ -1,60 +1,60 @@
 d1_client/__init__.py,sha256=cTpR_N6A5iGaNvJHlFy3c9HMZRaNe2aETEwJTL_3Nsg,1779
-d1_client/baseclient.py,sha256=JmBFmYKNhZZ_XzRQTHxSsXNTH6gxpCqv3KQ8gFWGUPI,25978
+d1_client/baseclient.py,sha256=bn7yc7dLkE4lBPHAiNotCdIZ3MOk_MHxIVhPOt3zYoU,26014
 d1_client/baseclient_1_1.py,sha256=2muPGJvAVXqoSLfVsCfM0UODPMQIjhh3w78H9i0Afx4,5193
 d1_client/baseclient_1_2.py,sha256=wyYBaQ6jRFRLoafL6fXMl6TqllfEQcPpm7Uu3ahuhjY,2092
 d1_client/baseclient_2_0.py,sha256=jL9iM2-YJJTxXrDlLnbRkz6IniI-l8oMTOg_W8xh05s,2856
 d1_client/cnclient.py,sha256=7qPnzd7JxQlAWvDUnDvHpVUg0MDU24NyBgF0G-IlWJ4,33311
 d1_client/cnclient_1_1.py,sha256=SPxlSyFMMrbtYeFtJO844EaUUlAXuygykUKHbm8C0zE,1787
 d1_client/cnclient_1_2.py,sha256=p-DrkLAC_kr-15agRyGsR0hSi202YjMiIh-VlCYxlMk,1787
 d1_client/cnclient_2_0.py,sha256=gvJ3gvG_BFdBYy7dDkifJjJe2NYvRhKKOFDtHnhaupo,6224
 d1_client/command_line.py,sha256=AaHZzyJG8agvDVoM7jt3CQu0BP3JTaGOMG5uJPf2Bv0,10249
 d1_client/d1client.py,sha256=5DSMuryf-w00OwDFO3H0psX14JCMmzl_Y-TK7w8KdJU,6913
 d1_client/mnclient.py,sha256=qatEAQhVB9icfoL0h8goGt2e8qqr_jFx49Pnxzn5JsI,8348
 d1_client/mnclient_1_1.py,sha256=vjuenJb4twGbuwDRSe8gUvrEAiNQuObsCCm0y_Meaoc,1769
 d1_client/mnclient_1_2.py,sha256=TQsiEBTmkmsCzJHSGmBFANGQRddJXtPOUNlotxS_LBs,3410
 d1_client/mnclient_2_0.py,sha256=qYEgzTwshO7z6wzrcJ-T41tW3KScXrhDEyVOYNlE7bM,1790
-d1_client/session.py,sha256=uVwuRviMeEjy55abvVMSfkcrOa7SSt4oWJwe-cclFS8,18409
+d1_client/session.py,sha256=qaga5IwilhRtAcvuhVRV4uHWjqDouuPGyVGv5ZS2t2g,19006
 d1_client/solr_client.py,sha256=vIwxhd_omubcA97VD_rh8Yxb1F1aVNS_WnRQUdYj5RE,31502
 d1_client/util.py,sha256=Fz_B79L6vpGWi65hivmTeCnipO58NbDm8G9QANzhipE,1643
 d1_client/aio/__init__.py,sha256=QLkzDLP-chxIHRFt5OS8wOgKgEUXkpJVMBvJHdQVams,1029
 d1_client/aio/async_client.py,sha256=ZOO_oOB9G5b-35REsdxtVEs5z9fGeLewq7mPRiEl1bg,11024
 d1_client/aio/command_line.py,sha256=4Yi4jYPjOg64rzltGwz-8Vb0ihi7jNKYwrR0Dku_aC4,4266
 d1_client/aio/util.py,sha256=O9qShct2EIXhJ6wzzHx2q_xQRQH_TK40kkfztuknxeE,3615
 d1_client/aio/iter/__init__.py,sha256=tOsCIwa8M9tIG_jMh2BFzwEv3HmfnyLCpb_wDFbWf3Y,1449
 d1_client/aio/iter/base_async.py,sha256=baHVSUaTkJtHvVKQwAl_7L7PksSfg6ubgu93SY2f_Hc,4939
 d1_client/aio/iter/eventlog_async.py,sha256=ZdXyZv7COy_MzfzNxygXth8Mky7ZEuEAucAchRVZ7B4,2800
 d1_client/aio/iter/eventlog_cmd.py,sha256=L_JNQrT0VF-6pcVHEOktT_ccHbFrLlHWdfeKZkqsNlw,2568
 d1_client/aio/iter/objectlist_async.py,sha256=SjhQxrSY1GV2y2UOdSTq3fCRO6OIe5-Zn4sdvNQMEfU,2838
 d1_client/aio/iter/objectlist_cmd.py,sha256=i0heRt4Iu42ks5FRZ-iis9Is8jVOtMPg4DwkhiSLsj8,2570
 d1_client/aio/iter/test.py,sha256=xaWuaz4CIAm0oSIxRPIZiInT_UqLACNkNhWWtaf_VoQ,858
 d1_client/iter/__init__.py,sha256=pAXtlAkc6RRrTkzoNuimZFtOLB55cGh06ymkGFAfqm8,1324
-d1_client/iter/base_multi.py,sha256=w7yZIOFo8NqHjQuybQs0p8Uts7eP9Uem9UBWPmsxHoU,7674
+d1_client/iter/base_multi.py,sha256=DnWiBMScggwqfi9uOTdrmB5LNnsuXHAEe1JaZwh08LA,7851
 d1_client/iter/logrecord.py,sha256=Yc_A04MWDTbNyfggCG4BskOOcfn2Zmyxfcte1C6Xres,3891
 d1_client/iter/logrecord_multi.py,sha256=cmqJl0Dw7lkAXF1R_Ffs50uY1yEBp1SuqXLdmCktskI,2200
 d1_client/iter/node.py,sha256=JYUt7qd5Dg6ea6IZoGDJM7oZMg5E79QKncS4kTjTuPU,1566
 d1_client/iter/objectlist.py,sha256=rwalzGBzf4LI_08iqqK11cJTNmBH-kWEJ9nl7d9AQuY,4376
 d1_client/iter/objectlist_multi.py,sha256=rmczwkZDSKKXJMXtJ2qajwqNGfSKsCfn3D6OdeXh5F0,2276
-d1_client/iter/sysmeta_multi.py,sha256=gASf3bOra21Vjm8lD41yHK2TI_slelKv_qWS7mqFRd0,2823
+d1_client/iter/sysmeta_multi.py,sha256=O2csOdF-eMhU_gtjK1ypm8SJCWw9NaL5FNchMsND4fw,2839
 d1_client/tests/__init__.py,sha256=WElrB0yVpQZcNdBkl4g5A-qRXx6Bmsf3YcNvcWPxpLM,788
 d1_client/tests/shared_context.py,sha256=ttXWhVFnxjHtIIU9i6wZ6xXqfZ2qPEaoXUhn2zekUTQ,936
 d1_client/tests/test_baseclient_1_0.py,sha256=9DeqAach-6R4RjCWJF1UwwxVjU-BJaRjD2BFv72dBdU,10257
 d1_client/tests/test_baseclient_1_1.py,sha256=fuso1DZZMIFkSe8ms8r-Ic4_NevUnkYOJanPm9sLHag,2708
 d1_client/tests/test_baseclient_2_0.py,sha256=h15_BgYG5jqhfEYE43PD3XG1eXUnnMHYre87QActTUU,915
 d1_client/tests/test_cnclient_1_0.py,sha256=s50tz1ASlKZ-fmxu97JdqVS6lq6wFMoxzW2Zj5Z5CT4,33309
 d1_client/tests/test_cnclient_1_1.py,sha256=AXTcWIzSq3Fa6pPkRGQBMaKodccNm9brJnmeMXeH0Ns,1494
 d1_client/tests/test_cnclient_2_0.py,sha256=dETBAf0Z8OXZWy3W87r5Vl6BLG-Jn4yck6VjQALYL2M,6166
 d1_client/tests/test_d1client.py,sha256=tGzS5bj8cZt43ofyNsg_2Y-lgMKtZin3iOutJTBaYZE,2988
 d1_client/tests/test_iter_log_record.py,sha256=ThB8QInWuqPjxmmYhn22utg-3GmfVRLcPYWAHzKNO1g,3117
-d1_client/tests/test_iter_log_record_multi.py,sha256=jR1mM6AFtuJSpG2yW4GPRPaqjt6ykN3ojuUop-qdYG4,2837
-d1_client/tests/test_iter_object_list_multi.py,sha256=SuAeAE4rIUBIiuC86KFR8yzVoCgFruj7Td40sw-NYoE,2379
-d1_client/tests/test_iter_sysmeta_multi.py,sha256=VtEoslbFmCYXM9ixJ3Oyr1v7ZEylXyPNgIXbvZdJFQE,4132
+d1_client/tests/test_iter_log_record_multi.py,sha256=kCq1E4jyE16P64oieZByyCg-gKK-M7Ji7WkZtGwKUi0,2866
+d1_client/tests/test_iter_object_list_multi.py,sha256=qr2UDKCIa-X02ml1dh7Dh94kzjnuJVPbcAhaP0oJsRI,2358
+d1_client/tests/test_iter_sysmeta_multi.py,sha256=QB3AGsoTpOM1Efcpt5MBcjOJxhSNHYnOup_TX_nJ7Ag,4933
 d1_client/tests/test_mnclient_1_0.py,sha256=dPT7EVJa6v6spYlWrvVxamUG3oRSetqthO4IAtj238Y,2511
 d1_client/tests/test_mnclient_1_1.py,sha256=stVFrVnj9TYQfugIRAp4UTyxYZcx6_rO4doKhuY5fI4,908
 d1_client/tests/test_mnclient_2_0.py,sha256=9URSvTb-aLsu7GPhnJhBF7d0zbSyjQo6npwdYG_N8e0,2215
 d1_client/tests/test_session.py,sha256=nw3ssdzl-2TBLHrxJITKQQxW79I-M9tkWEdU3zaflqY,5850
 d1_client/tests/test_solr_client.py,sha256=vuZT503a25BYBzoSkGYEVhu-8W3AFixX8-Fn_CpwD8A,7330
 d1_client/tests/test_util.py,sha256=mFeCjmH5vUgmM_-36tpVucis1rokVogeZ0JC2_As7u4,1880
-dataone.libclient-3.5.0.dist-info/METADATA,sha256=Vtf_2Y6fNPK631TxXizZbkOJJmklAARcEPDQudBwov0,851
-dataone.libclient-3.5.0.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-dataone.libclient-3.5.0.dist-info/top_level.txt,sha256=tKDHacUErJEQhNc6JowsQH6XRv8pBzMWiT5XXgMifF4,10
-dataone.libclient-3.5.0.dist-info/RECORD,,
+dataone.libclient-3.5.2.dist-info/METADATA,sha256=05vdV_6YsTpnaUgjjACnNYH7C4csCk1JKKSve8VVxNA,827
+dataone.libclient-3.5.2.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+dataone.libclient-3.5.2.dist-info/top_level.txt,sha256=tKDHacUErJEQhNc6JowsQH6XRv8pBzMWiT5XXgMifF4,10
+dataone.libclient-3.5.2.dist-info/RECORD,,
```

