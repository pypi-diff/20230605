# Comparing `tmp/kyzylborda_lib-1.0.3-py3-none-any.whl.zip` & `tmp/kyzylborda_lib-1.0.4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,40 +1,39 @@
-Zip file size: 37067 bytes, number of entries: 38
+Zip file size: 31902 bytes, number of entries: 37
 -rw-rw-r--  2.0 unx        0 b- defN 22-Nov-04 12:05 kyzylborda_lib/__init__.py
 -rw-rw-r--  2.0 unx      300 b- defN 22-Nov-07 21:02 kyzylborda_lib/generator/__init__.py
 -rw-rw-r--  2.0 unx     2560 b- defN 23-Jun-03 12:24 kyzylborda_lib/generator/__main__.py
 -rw-rw-r--  2.0 unx      218 b- defN 22-Nov-14 17:20 kyzylborda_lib/libc/__init__.py
 -rw-rw-r--  2.0 unx      199 b- defN 23-Jun-03 12:24 kyzylborda_lib/sandbox/__init__.py
 -rw-rw-r--  2.0 unx     3730 b- defN 23-Jun-03 12:24 kyzylborda_lib/sandbox/box.py
 -rw-rw-r--  2.0 unx     2926 b- defN 23-Jun-03 12:24 kyzylborda_lib/sandbox/environment.py
 -rw-rw-r--  2.0 unx     1889 b- defN 22-Nov-14 17:20 kyzylborda_lib/sandbox/health_checks.py
--rw-rw-r--  2.0 unx    17115 b- defN 22-Nov-11 16:40 kyzylborda_lib/sandbox/isolate.py
 -rw-rw-r--  2.0 unx     1677 b- defN 22-Nov-10 07:33 kyzylborda_lib/sandbox/readiness.py
 -rw-rw-r--  2.0 unx     6451 b- defN 23-Jun-03 12:24 kyzylborda_lib/sandbox/start.py
 -rw-rw-r--  2.0 unx     3147 b- defN 22-Nov-08 09:14 kyzylborda_lib/secrets/__init__.py
 -rw-rw-r--  2.0 unx     1591 b- defN 23-Jun-03 12:24 kyzylborda_lib/secrets/autodetect.py
 -rw-rw-r--  2.0 unx     2888 b- defN 23-Jun-03 12:24 kyzylborda_lib/secrets/default_generator.py
 -rw-rw-r--  2.0 unx     4919 b- defN 22-Nov-09 22:41 kyzylborda_lib/secrets/encoding.py
 -rw-rw-r--  2.0 unx    11072 b- defN 22-Nov-09 22:41 kyzylborda_lib/secrets/patterns.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Nov-04 16:37 kyzylborda_lib/server/__init__.py
 -rw-rw-r--  2.0 unx      579 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/__main__.py
 -rw-rw-r--  2.0 unx     1904 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/address.py
 -rw-rw-r--  2.0 unx      151 b- defN 22-Nov-04 16:33 kyzylborda_lib/server/handlers.py
--rw-rw-r--  2.0 unx     2658 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/http/__init__.py
+-rw-rw-r--  2.0 unx     2742 b- defN 23-Jun-05 04:59 kyzylborda_lib/server/http/__init__.py
 -rw-rw-r--  2.0 unx     1531 b- defN 22-Nov-10 11:52 kyzylborda_lib/server/http/connection.py
 -rw-rw-r--  2.0 unx      792 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/http/pre_handler.py
 -rw-rw-r--  2.0 unx     3102 b- defN 22-Nov-04 21:17 kyzylborda_lib/server/http/protocol_commons.py
 -rw-rw-r--  2.0 unx     3428 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/http/request.py
 -rw-rw-r--  2.0 unx     5387 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/http/response.py
 -rw-rw-r--  2.0 unx      811 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/tcp/__init__.py
 -rw-rw-r--  2.0 unx      566 b- defN 23-Jun-05 00:11 kyzylborda_lib/server/tcp/bridge.py
 -rw-rw-r--  2.0 unx     2641 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/tcp/connection.py
 -rw-rw-r--  2.0 unx     3052 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/tcp/reverse_proxy.py
 -rw-rw-r--  2.0 unx      811 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/udp/__init__.py
 -rw-rw-r--  2.0 unx      478 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/udp/bridge.py
 -rw-rw-r--  2.0 unx     3007 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/udp/connection.py
 -rw-rw-r--  2.0 unx     3351 b- defN 23-Jun-03 12:24 kyzylborda_lib/server/udp/reverse_proxy.py
--rw-rw-r--  2.0 unx      245 b- defN 23-Jun-05 00:14 kyzylborda_lib-1.0.3.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Jun-05 00:14 kyzylborda_lib-1.0.3.dist-info/WHEEL
--rw-rw-r--  2.0 unx       15 b- defN 23-Jun-05 00:14 kyzylborda_lib-1.0.3.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3474 b- defN 23-Jun-05 00:14 kyzylborda_lib-1.0.3.dist-info/RECORD
-38 files, 98757 bytes uncompressed, 31395 bytes compressed:  68.2%
+-rw-rw-r--  2.0 unx      245 b- defN 23-Jun-05 05:02 kyzylborda_lib-1.0.4.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Jun-05 05:02 kyzylborda_lib-1.0.4.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       15 b- defN 23-Jun-05 05:02 kyzylborda_lib-1.0.4.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3383 b- defN 23-Jun-05 05:02 kyzylborda_lib-1.0.4.dist-info/RECORD
+37 files, 81635 bytes uncompressed, 26372 bytes compressed:  67.7%
```

## zipnote {}

```diff
@@ -18,17 +18,14 @@
 
 Filename: kyzylborda_lib/sandbox/environment.py
 Comment: 
 
 Filename: kyzylborda_lib/sandbox/health_checks.py
 Comment: 
 
-Filename: kyzylborda_lib/sandbox/isolate.py
-Comment: 
-
 Filename: kyzylborda_lib/sandbox/readiness.py
 Comment: 
 
 Filename: kyzylborda_lib/sandbox/start.py
 Comment: 
 
 Filename: kyzylborda_lib/secrets/__init__.py
@@ -96,20 +93,20 @@
 
 Filename: kyzylborda_lib/server/udp/connection.py
 Comment: 
 
 Filename: kyzylborda_lib/server/udp/reverse_proxy.py
 Comment: 
 
-Filename: kyzylborda_lib-1.0.3.dist-info/METADATA
+Filename: kyzylborda_lib-1.0.4.dist-info/METADATA
 Comment: 
 
-Filename: kyzylborda_lib-1.0.3.dist-info/WHEEL
+Filename: kyzylborda_lib-1.0.4.dist-info/WHEEL
 Comment: 
 
-Filename: kyzylborda_lib-1.0.3.dist-info/top_level.txt
+Filename: kyzylborda_lib-1.0.4.dist-info/top_level.txt
 Comment: 
 
-Filename: kyzylborda_lib-1.0.3.dist-info/RECORD
+Filename: kyzylborda_lib-1.0.4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## kyzylborda_lib/server/http/__init__.py

```diff
@@ -31,19 +31,19 @@
 
 
 def listen(handler: Optional[HandlerType]=None, *, allow_keep_alive: bool=False):
     if handler is None:
         return partial(listen, allow_keep_alive=allow_keep_alive)
 
     @tcp.listen
-    async def wrapped(connection: tcp.Connection) -> tcp.Connection | str | None:
+    async def wrapped(connection: tcp.Connection):
         try:
             raw_header = await read_http_header(connection)
         except MalformedHeaderError:
-            return None
+            return
 
         req = Request(
             RequestHeader(raw_header),
             connection,
             server_address=connection.server_address,
             peer_address=connection.peer_address
         )
@@ -57,15 +57,15 @@
             if ret is None:
                 ret = await handler(req)
         except Exception:
             traceback.print_exc()
             ret = respond(500)
 
         if ret is None:
-            return None
+            return
 
         if isinstance(ret, Box):
             box = ret
             with box.borrow():  # don't let the box be deleted while we are using it
                 address = box.get_socket_address()
                 if address is None:
                     raise ValueError(f"Box {box} does not bind to a socket--check kyzylborda-box.yml.")
@@ -78,11 +78,13 @@
         if isinstance(ret, Response):
             if not allow_keep_alive:
                 del ret.headers["Connection"]
                 ret.headers["Connection"] = "close"
             await connection.writeall(ret.raw_header)
             if isinstance(ret.data, bytes):
                 connection.write(ret.data)
-                return None
+                return
             ret = ret.data
 
-        return ret
+        if isinstance(ret, tcp.Connection):
+            async with ret:
+                await tcp.bridge_connections_unidirectional(ret, connection)
```

## Comparing `kyzylborda_lib-1.0.3.dist-info/RECORD` & `kyzylborda_lib-1.0.4.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -2,37 +2,36 @@
 kyzylborda_lib/generator/__init__.py,sha256=_8V5i0X8XHDML7TEU-iUY3cOOcC40kKcsxmqmnnCyVo,300
 kyzylborda_lib/generator/__main__.py,sha256=vOxZ1LZJn0Y9sztz9nxbUAMsFUZjuchrg8MFd0lJxoY,2560
 kyzylborda_lib/libc/__init__.py,sha256=x2vV_IqEpTrFiK9ZTqB8FlMrq5INYZx-WG1tBjJijy4,218
 kyzylborda_lib/sandbox/__init__.py,sha256=S81tJbR0x-vLlojxcKO4C_QYeILc--ibtL_s3-uztuI,199
 kyzylborda_lib/sandbox/box.py,sha256=mPPg3st7MYTCqYkrJvJFhJE722Ys0NJ5RIT_frCyuqc,3730
 kyzylborda_lib/sandbox/environment.py,sha256=4T8XBp5tgXPTnMa38CxJmB2LquuOcjWo_px1RDgNuhE,2926
 kyzylborda_lib/sandbox/health_checks.py,sha256=hme7n1_F-M-tdq-yZBc0ZmTDDdDBjffADxg-LSZ2bLk,1889
-kyzylborda_lib/sandbox/isolate.py,sha256=GmV9ty3zoN7PvYNupmas0cbm6OV61WygjLwktXVLaVw,17115
 kyzylborda_lib/sandbox/readiness.py,sha256=VsOZ3bJRzLTISJMf1BlwIcDaH1mM5TxsVTnKkIfpKLQ,1677
 kyzylborda_lib/sandbox/start.py,sha256=vQ6cxBiQOuuDn1dzXHL5DAKHTW3KATh8_WVz-bOMMHM,6451
 kyzylborda_lib/secrets/__init__.py,sha256=ibw6kM9SeUTA4l7SNem3u4IzmUpJjUJWO3bIXkc0QX4,3147
 kyzylborda_lib/secrets/autodetect.py,sha256=tSrfYE2TnxCYuA7LNNUUKF6Fvj0QthXRCGfGSZA_2NE,1591
 kyzylborda_lib/secrets/default_generator.py,sha256=pd8swu60khUTrVaI2fiBkB6Vv3KYaSzi65WkPRjKrg8,2888
 kyzylborda_lib/secrets/encoding.py,sha256=4bXX_ubtdZBI_3zD79pRV3kruh-ZPUqtCFlGsohDDhc,4919
 kyzylborda_lib/secrets/patterns.py,sha256=BOjbO66g_-T_ZlACiaplhlMhtVJyKEFQko0iodujdzY,11072
 kyzylborda_lib/server/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kyzylborda_lib/server/__main__.py,sha256=0c6l_k_JWIu-MCCsdf-jNLfqnQVCrevVb3GMhQaZ9W4,579
 kyzylborda_lib/server/address.py,sha256=9sVkSD0L7rzpf0xIvblZXdR9qp7xCNa_iEQ_jDKIT4o,1904
 kyzylborda_lib/server/handlers.py,sha256=k95-jiznOQMHiibb0zFdOsBz_6YwHz8pVQk-yY-ZQ1M,151
-kyzylborda_lib/server/http/__init__.py,sha256=SViDZoFnXnsqh5wMQ0oRL1kp_XZfR7JQtMhqm-IK-iE,2658
+kyzylborda_lib/server/http/__init__.py,sha256=IrcMYndY5hn8GBRhAvqGfeGvimSJYfFumYn8OM8gvSs,2742
 kyzylborda_lib/server/http/connection.py,sha256=drICxALP7ORaOBIpZ-znM_PBeGuQ9-LsaAC6BcpEaH4,1531
 kyzylborda_lib/server/http/pre_handler.py,sha256=ms5-XHnAKIfKUtY3R4g4fZZ6xF5Q1KdFAsb3h3avMu0,792
 kyzylborda_lib/server/http/protocol_commons.py,sha256=y1NTITVNFeCLH9GmKR1lNWENjVkzJFji56Lmu6WCFWU,3102
 kyzylborda_lib/server/http/request.py,sha256=uZczpPRXlqoXnlzxwOS3elLqUAKejeo5zQfrCO2KdAA,3428
 kyzylborda_lib/server/http/response.py,sha256=_tohcrLgl_G6NIPL9ZaUHZJJTETBj9vMLy_HTzYtD88,5387
 kyzylborda_lib/server/tcp/__init__.py,sha256=zb-y8VKEaNZvP0G778FLJwS868umS6U0KPTbLAH4PgQ,811
 kyzylborda_lib/server/tcp/bridge.py,sha256=RYxNVyg-B5EebU-30346dROZ5CkrBd5la_Yhw0GImmQ,566
 kyzylborda_lib/server/tcp/connection.py,sha256=hhAJgTlfhEMulQ2Gcy9dyof3QRNGia0h8nlDTTPMKHg,2641
 kyzylborda_lib/server/tcp/reverse_proxy.py,sha256=haJ2CF1cjWc3RMC9UmKnrsS0LNGlXw9VGTtzUNyOb8Q,3052
 kyzylborda_lib/server/udp/__init__.py,sha256=zb-y8VKEaNZvP0G778FLJwS868umS6U0KPTbLAH4PgQ,811
 kyzylborda_lib/server/udp/bridge.py,sha256=i_sXlEYue2gbNJ68wiS50FnMXfv7B0F_RCeWpyRtzos,478
 kyzylborda_lib/server/udp/connection.py,sha256=xSC22T5rRbzbP0k44xWYyj5p4eUf9vSH_DY0C87hrQI,3007
 kyzylborda_lib/server/udp/reverse_proxy.py,sha256=j4JCKIszbGhYnJZXm9uSk1cPS7KcBLEs9KJPdFO4Ano,3351
-kyzylborda_lib-1.0.3.dist-info/METADATA,sha256=0cxMS2ccnRhJN4aYaPakH-6J9SnbgfkiMZHRWDV5FBs,245
-kyzylborda_lib-1.0.3.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-kyzylborda_lib-1.0.3.dist-info/top_level.txt,sha256=ZzS_Nrs1YuMp26WCffUbZkmqDIgSGTMjGb1ogszX-5s,15
-kyzylborda_lib-1.0.3.dist-info/RECORD,,
+kyzylborda_lib-1.0.4.dist-info/METADATA,sha256=j4KfZHAOMImjzuN5VRhrqB9XbxpRUA6qE9xzSGjECHs,245
+kyzylborda_lib-1.0.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+kyzylborda_lib-1.0.4.dist-info/top_level.txt,sha256=ZzS_Nrs1YuMp26WCffUbZkmqDIgSGTMjGb1ogszX-5s,15
+kyzylborda_lib-1.0.4.dist-info/RECORD,,
```

